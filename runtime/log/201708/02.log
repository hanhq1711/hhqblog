[ 2017-08-02T00:03:37+08:00 ] 172.17.180.47 106.11.153.67 GET /ar/30.html
[ log ] www.hhqblog.com/ar/30.html [运行时间：0.032989s][吞吐率：30.31req/s] [内存消耗：4,017.09kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'accept-language' => 'zh-cn,en-us,zh-tw,en-gb,en;',
  'host' => 'www.hhqblog.com',
  'accept-encoding' => 'gzip',
  'accept' => '*/*',
  'connection' => 'Keep-Alive',
  'user-agent' => 'YisouSpider',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '30',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000276s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000798s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000621s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000354s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000350s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 30 LIMIT 1 [ RunTime:0.000226s ]

---------------------------------------------------------------
[ 2017-08-02T00:09:05+08:00 ] 172.17.180.47 61.135.165.43 GET /
[ log ] www.hhqblog.com/ [运行时间：0.031437s][吞吐率：31.81req/s] [内存消耗：4,630.21kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.80 Safari/537.36',
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000288s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000814s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000481s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000358s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000331s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000229s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000488s ]

---------------------------------------------------------------
[ 2017-08-02T01:15:43+08:00 ] 172.17.180.47 220.181.108.117 GET /
[ log ] www.hhqblog.com/ [运行时间：0.034609s][吞吐率：28.89req/s] [内存消耗：4,598.48kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-language' => 'zh-cn,zh-tw',
  'if-none-match' => '"@NULL@"',
  'accept-encoding' => 'gzip',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000312s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000823s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000665s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000339s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000355s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000308s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000325s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000233s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000459s ]

---------------------------------------------------------------
[ 2017-08-02T01:16:02+08:00 ] 172.17.180.47 111.206.221.33 GET /index/index/index.html?page=1
[ log ] www.hhqblog.com/index/index/index.html?page=1 [运行时间：0.040077s][吞吐率：24.95req/s] [内存消耗：4,617.23kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1 (compatible; Baiduspider-render/2.0; +http://www.baidu.com/search/spider.html)',
  'proxy-connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-devtools-emulate-network-conditions-client-id' => '60770f83-3678-4e31-9e4f-108f8cf3ecf4',
  'x-requested-with' => 'XMLHttpRequest',
  'accept-language' => 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',
  'resource-type' => '13',
  'referer' => 'http://www.hhqblog.com/',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000374s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.001182s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000671s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000533s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000335s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000697s ]

---------------------------------------------------------------
[ 2017-08-02T02:25:32+08:00 ] 172.17.180.47 45.63.1.212 HEAD /
[ log ] hhqblog.com/ [运行时间：0.033099s][吞吐率：30.21req/s] [内存消耗：4,597.92kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'user-agent' => 'DomainCheck.io Crawler/1.3 (https://domaincheck.io)',
  'accept' => '*/*',
  'referer' => 'https://domaincheck.io/hhqblog.com',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000299s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000801s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000619s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000335s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000342s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000309s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000308s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000230s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000451s ]

---------------------------------------------------------------
[ 2017-08-02T02:52:26+08:00 ] 172.17.180.47 202.108.211.56 GET /
[ log ] www.hhqblog.com/ [运行时间：0.031450s][吞吐率：31.80req/s] [内存消耗：4,642.05kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.21 (KHTML, like Gecko) Chrome/19.0.1042.0 Safari/535.21',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate, sdch',
  'accept-language' => 'zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'upgrade-insecure-requests' => '1',
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000296s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000805s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000480s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000375s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000239s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000494s ]

---------------------------------------------------------------
[ 2017-08-02T03:40:36+08:00 ] 172.17.180.47 140.205.201.46 GET /
[ log ] www.hhqblog.com/ [运行时间：0.033882s][吞吐率：29.51req/s] [内存消耗：4,598.40kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'host' => 'www.hhqblog.com',
  'referer' => 'http://www.hhqblog.com/',
  'accept' => '*/*',
  'connection' => 'keep-alive',
  'accept-encoding' => 'gzip,deflate',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000298s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000795s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000669s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000363s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000364s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000306s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000319s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000238s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000451s ]

---------------------------------------------------------------
[ 2017-08-02T03:40:41+08:00 ] 172.17.180.47 140.205.201.46 GET /editors/index.html
[ log ] www.hhqblog.com/editors/index.html [运行时间：0.014311s][吞吐率：69.88req/s] [内存消耗：1,586.70kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'editors',
    1 => 'index',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T03:41:17+08:00 ] 172.17.180.47 140.205.201.46 GET /LICENSE.txt
[ log ] www.hhqblog.com/LICENSE.txt [运行时间：0.012922s][吞吐率：77.39req/s] [内存消耗：1,586.75kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'LICENSE.txt',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T03:41:18+08:00 ] 172.17.180.47 140.205.201.46 GET /extensions/kindeditor/themes/default/default.png)
[ log ] www.hhqblog.com/extensions/kindeditor/themes/default/default.png) [运行时间：0.012644s][吞吐率：79.09req/s] [内存消耗：1,587.30kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'extensions',
    1 => 'kindeditor',
    2 => 'themes',
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'default' => 'default.png)',
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T03:43:36+08:00 ] 172.17.180.47 64.246.165.140 GET /
[ log ] www.hhqblog.com/ [运行时间：0.033459s][吞吐率：29.89req/s] [内存消耗：4,642.58kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'te' => 'deflate,gzip;q=0.3',
  'connection' => 'close, TE',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, x-gzip, deflate',
  'accept-language' => 'en-us,fr-be;q=0.5',
  'from' => 'feedback@surveybot.com',
  'host' => 'www.hhqblog.com',
  'referer' => 'http://whois.domaintools.com/hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en; rv:1.9.0.13) Gecko/2009073022 Firefox/3.5.2 (.NET CLR 3.5.30729) SurveyBot/2.3 (DomainTools)',
  'wshost' => 'www.hhqblog.com',
  'wsip' => '47.93.49.112',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000336s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000931s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000551s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000384s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000269s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000532s ]

---------------------------------------------------------------
[ 2017-08-02T04:31:55+08:00 ] 172.17.180.47 66.249.64.70 GET /ar/20.html
[ log ] hhqblog.com/ar/20.html [运行时间：0.031478s][吞吐率：31.77req/s] [内存消耗：4,103.97kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'Keep-alive',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
  'from' => 'googlebot(at)googlebot.com',
  'user-agent' => 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)',
  'accept-encoding' => 'gzip,deflate,br',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '20',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000275s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.001686s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000509s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 20 LIMIT 1 [ RunTime:0.000287s ]

---------------------------------------------------------------
[ 2017-08-02T04:56:10+08:00 ] 172.17.180.47 157.55.39.103 GET /misc/ads/
[ log ] hhqblog.com/misc/ads/ [运行时间：0.013891s][吞吐率：71.99req/s] [内存消耗：1,587.14kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'misc',
    1 => 'ads',
    2 => 'index.php',
  ),
)
[ info ] [ HEADER ] array (
  'cache-control' => 'no-cache',
  'connection' => 'Keep-Alive',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, deflate',
  'from' => 'bingbot(at)microsoft.com',
  'host' => 'hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T05:14:56+08:00 ] 172.17.180.47 141.8.144.117 GET /
[ log ] hhqblog.com/ [运行时间：0.034325s][吞吐率：29.13req/s] [内存消耗：4,598.59kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'Keep-Alive',
  'user-agent' => 'Mozilla/5.0 (compatible; YandexBot/3.0; +http://yandex.com/bots)',
  'from' => 'support@search.yandex.ru',
  'accept-encoding' => 'gzip,deflate',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000297s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000809s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000632s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000382s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000364s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000301s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000328s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000258s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000485s ]

---------------------------------------------------------------
[ 2017-08-02T05:28:15+08:00 ] 172.17.180.47 66.249.64.70 GET /
[ log ] hhqblog.com/ [运行时间：0.031794s][吞吐率：31.45req/s] [内存消耗：4,641.41kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'Keep-alive',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
  'from' => 'googlebot(at)googlebot.com',
  'user-agent' => 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)',
  'accept-encoding' => 'gzip,deflate,br',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000288s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000833s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000493s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000373s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000277s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000503s ]

---------------------------------------------------------------
[ 2017-08-02T06:49:34+08:00 ] 172.17.180.47 61.48.40.26 GET /
[ log ] hhqblog.com/ [运行时间：0.033877s][吞吐率：29.52req/s] [内存消耗：4,597.97kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'user-agent' => 'Apache-HttpClient/4.5.2 (Java/1.7.0_55)',
  'accept-encoding' => 'gzip,deflate',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000306s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000803s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000624s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000338s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000355s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000326s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000325s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000244s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000454s ]

---------------------------------------------------------------
[ 2017-08-02T09:15:07+08:00 ] 172.17.180.47 220.181.108.151 GET /
[ log ] www.hhqblog.com/ [运行时间：0.033849s][吞吐率：29.54req/s] [内存消耗：4,598.48kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-language' => 'zh-cn,zh-tw',
  'if-none-match' => '"@NULL@"',
  'accept-encoding' => 'gzip',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000293s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000827s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000601s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000347s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000349s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000289s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000320s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000242s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000430s ]

---------------------------------------------------------------
[ 2017-08-02T09:15:34+08:00 ] 172.17.180.47 111.206.221.40 GET /index/index/index.html?page=1
[ log ] www.hhqblog.com/index/index/index.html?page=1 [运行时间：0.031619s][吞吐率：31.63req/s] [内存消耗：4,617.23kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1 (compatible; Baiduspider-render/2.0; +http://www.baidu.com/search/spider.html)',
  'proxy-connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-devtools-emulate-network-conditions-client-id' => '99145268-16f5-49f4-853d-6a19e59a007a',
  'x-requested-with' => 'XMLHttpRequest',
  'accept-language' => 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',
  'resource-type' => '13',
  'referer' => 'http://www.hhqblog.com/',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000319s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000823s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000492s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000371s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000252s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000502s ]

---------------------------------------------------------------
[ 2017-08-02T09:41:31+08:00 ] 172.17.180.47 157.55.39.81 GET /
[ log ] www.hhqblog.com/ [运行时间：0.037287s][吞吐率：26.82req/s] [内存消耗：4,641.74kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'cache-control' => 'no-cache',
  'connection' => 'Keep-Alive',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, deflate',
  'from' => 'bingbot(at)microsoft.com',
  'host' => 'www.hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000442s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000904s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000526s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000367s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000289s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000500s ]

---------------------------------------------------------------
[ 2017-08-02T12:52:05+08:00 ] 172.17.180.47 141.8.144.117 GET /ar/24.html
[ log ] hhqblog.com/ar/24.html [运行时间：0.031566s][吞吐率：31.68req/s] [内存消耗：4,020.53kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'Keep-Alive',
  'user-agent' => 'Mozilla/5.0 (compatible; YandexBot/3.0; +http://yandex.com/bots)',
  'from' => 'support@search.yandex.ru',
  'accept-encoding' => 'gzip,deflate',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '24',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000298s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000792s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000626s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000346s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000341s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 24 LIMIT 1 [ RunTime:0.000226s ]

---------------------------------------------------------------
[ 2017-08-02T13:44:04+08:00 ] 172.17.180.47 157.55.39.81 GET /
[ log ] hhqblog.com/ [运行时间：0.034661s][吞吐率：28.85req/s] [内存消耗：4,630.77kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'cache-control' => 'no-cache',
  'connection' => 'Keep-Alive',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, deflate',
  'from' => 'bingbot(at)microsoft.com',
  'host' => 'hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000334s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000898s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000588s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000393s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000354s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000244s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000578s ]

---------------------------------------------------------------
[ 2017-08-02T14:19:01+08:00 ] 172.17.180.47 123.233.116.122 GET /admin
[ log ] hhqblog.com/admin [运行时间：0.016080s][吞吐率：62.19req/s] [内存消耗：1,977.95kb] [文件加载：44]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Index->index[ /yjdata/www/hhqblog/application/admin/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/public/index.html [ array (
) ]
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:19:01+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/index/main.html
[ log ] hhqblog.com/admin/index/main.html [运行时间：0.015241s][吞吐率：65.61req/s] [内存消耗：1,900.90kb] [文件加载：43]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'index',
    2 => 'main',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Index->main[ /yjdata/www/hhqblog/application/admin/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/index/index.html [ array (
  0 => 'info',
) ]
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:19:15+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] hhqblog.com/admin/article/index.html [运行时间：0.026080s][吞吐率：38.34req/s] [内存消耗：3,566.27kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000295s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000812s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000151s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000569s ]

---------------------------------------------------------------
[ 2017-08-02T14:19:15+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.027062s][吞吐率：36.95req/s] [内存消耗：3,497.23kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000273s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000820s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000162s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000577s ]

---------------------------------------------------------------
[ 2017-08-02T14:21:07+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/add_article.html
[ log ] hhqblog.com/admin/article/add_article.html [运行时间：0.023559s][吞吐率：42.45req/s] [内存消耗：2,987.12kb] [文件加载：51]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/add_article.html [ array (
  0 => 'cates',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000298s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article_cate` [ RunTime:0.000804s ]
[ sql ] [ SQL ] SELECT `id`,`name` FROM `think_article_cate` [ RunTime:0.000199s ]

---------------------------------------------------------------
[ 2017-08-02T14:22:49+08:00 ] 172.17.180.47 123.233.116.122 POST /admin/article/add_article.html
[ log ] hhqblog.com/admin/article/add_article.html [运行时间：0.214482s][吞吐率：4.66req/s] [内存消耗：3,785.82kb] [文件加载：61]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'content-length' => '171325',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://hhqblog.com',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'content-type' => 'multipart/form-data; boundary=----WebKitFormBoundaryzZ1WPlnBxHCI0ama',
  'referer' => 'http://hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
)
[ info ] [ PARAM ] array (
  'title' => '如何减少PHP-FPM的内存占用',
  'cate_id' => '17',
  'type' => '0',
  'keyword' => 'PHP-FPM,内存',
  'remark' => 'PHP-FPM是PHP的FastCGI过程管理器。在类Unix操作系统（包括Linux以及BSD系统）中，PHP-FPM通过安装php5-fpm(Linux)或者php56-fpm(FreeBSD 10.1)来使用。但是缺省安装以及按照大量博客推荐安装的PHP-FPM的最大问题是 ...',
  'content' => '<p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);"><code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>是<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP</code>的<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">FastCGI</code>过程管理器。在类<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">Unix</code>操作系统（包括<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">Linux</code>以及<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">BSD</code>系统）中，<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>通过安装<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">php5-fpm</code>(<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">Linux</code>)或者<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">php56-fpm</code>(<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">FreeBSD 10.1</code>)来使用。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">但是缺省安装以及按照大量博客推荐安装的<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>的最大问题是它会消耗大量资源，包括内存和<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">CPU</code>。本博客使用的服务器也遭遇了类似的命运。因为我也是按照那些教程安装的，而教程里对于<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>的配置选项描述的不够有效。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">你可以在<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">/etc/php5/fpm/pool.d</code>目录下发现这些低效的配置选项。举例来说，以下是我的服务器（当然不是目前这个站点）上的那些低效选项：</p><pre class="hljs lsl" style="word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;">;&nbsp;Choose&nbsp;how&nbsp;the&nbsp;process&nbsp;manager&nbsp;will&nbsp;control&nbsp;the&nbsp;number&nbsp;of&nbsp;child&nbsp;processes.
pm&nbsp;=&nbsp;dynamic
pm.max_children&nbsp;=&nbsp;75pm.start_servers&nbsp;=&nbsp;10pm.min_spare_servers&nbsp;=&nbsp;5pm.max_spare_servers&nbsp;=&nbsp;20pm.max_requests&nbsp;=&nbsp;500</pre><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">那台服务器是一台<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">DigitalOcean Droplet</code>，配置<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">512M</code>内存。它上面运行了一个新网站，即使完全空闲时，也必须要靠交换内存才能避免僵死。执行<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">top</code>命令显示了服务器上占用内存最多的进程。</p><pre class="hljs tap" style="word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;">&nbsp;&nbsp;PID&nbsp;USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR&nbsp;&nbsp;NI&nbsp;&nbsp;&nbsp;&nbsp;VIRT&nbsp;&nbsp;&nbsp;&nbsp;RES&nbsp;&nbsp;&nbsp;&nbsp;SHR&nbsp;S&nbsp;%CPU&nbsp;%MEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIME+&nbsp;COMMAND
13891&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396944&nbsp;&nbsp;56596&nbsp;&nbsp;33416&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.3&nbsp;&nbsp;&nbsp;:14.05&nbsp;php5-fpm
13889&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396480&nbsp;&nbsp;56316&nbsp;&nbsp;32916&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.2&nbsp;&nbsp;&nbsp;:17.67&nbsp;php5-fpm
13887&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;624212&nbsp;&nbsp;55088&nbsp;&nbsp;32008&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.0&nbsp;&nbsp;&nbsp;:14.02&nbsp;php5-fpm
13890&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396384&nbsp;&nbsp;55032&nbsp;&nbsp;32312&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.0&nbsp;&nbsp;&nbsp;:13.39&nbsp;php5-fpm
13888&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;397056&nbsp;&nbsp;54972&nbsp;&nbsp;31988&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.0&nbsp;&nbsp;&nbsp;:14.16&nbsp;php5-fpm
14464&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;397020&nbsp;&nbsp;54696&nbsp;&nbsp;31832&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:09.44&nbsp;php5-fpm
13892&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396640&nbsp;&nbsp;54704&nbsp;&nbsp;31936&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:12.84&nbsp;php5-fpm
&nbsp;
13883&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396864&nbsp;&nbsp;54692&nbsp;&nbsp;31940&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:15.64&nbsp;php5-fpm
13893&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396860&nbsp;&nbsp;54628&nbsp;&nbsp;32004&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:15.13&nbsp;php5-fpm
13885&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396852&nbsp;&nbsp;54412&nbsp;&nbsp;32116&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.8&nbsp;&nbsp;&nbsp;:13.94&nbsp;php5-fpm
13884&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;395164&nbsp;&nbsp;53916&nbsp;&nbsp;32364&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.7&nbsp;&nbsp;&nbsp;:13.51&nbsp;php5-fpm
13989&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;394960&nbsp;&nbsp;53548&nbsp;&nbsp;32108&nbsp;S&nbsp;&nbsp;3.7&nbsp;10.7&nbsp;&nbsp;&nbsp;:14.37&nbsp;php5-fpm
2778&nbsp;mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;1359152&nbsp;&nbsp;31704&nbsp;&nbsp;&nbsp;1728&nbsp;S&nbsp;&nbsp;0.7&nbsp;&nbsp;6.3&nbsp;&nbsp;&nbsp;1:38.80&nbsp;mysqld
&nbsp;
13849&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;373832&nbsp;&nbsp;&nbsp;1180&nbsp;&nbsp;&nbsp;&nbsp;188&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.2&nbsp;&nbsp;&nbsp;:03.27&nbsp;php5-fpm</pre><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">输出结果显示有<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">12</code>个<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">php5-fpm</code>子进程（用户名是<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">cont</code>）和一个主进程（用户名是<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">root</code>）。而这<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">12</code>个子进程只是呆坐在那里，什么事也不做，每个子进程白白消耗超过<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">10%</code>的内存。这些子进程主要是由<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm=dynamic</code>这个配置选项产生的。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">老实说，绝大部分的云主机拥有者也不知道所有这些配置选项是干什么用的，只是简单地复制粘贴而已。我也不准备假装我了解每个<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP</code>配置文件里的每一个选项的目的和意义。我在很大程度上也是复制粘贴的受害者。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">但是我经常检查服务器的资源占用情况，困惑于为什么我的服务器占用这么多的内存和<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">CPU</code>。举另外一个例子，是这台服务器上的<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">free -mt</code>命令的结果：</p><pre class="hljs tap" style="word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shared&nbsp;&nbsp;&nbsp;&nbsp;buffers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cached
Mem:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;490&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;480&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;79
-/+&nbsp;buffers/cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;393&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96
Swap:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2047&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;491&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1556
Total:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2538&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;971&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1566</pre><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">在没有任何访问量的情况下，也几乎有整整<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">1G</code>的内存（实际内存加上交换内存）被占用。当然，通过调整配置<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm</code>的数量可以有所改变，但只是轻微的。只要设置<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm=dynamic</code>，就会有空闲的子进程等在那里等待被使用。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">直到读了一篇文章《<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">A better way to run PHP-FPM</code>》(更好地运行<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>)之后，我开始意识到应该如何修改我的配置文件。那篇文章是大约一年前写的，令人失望的是我从昨天晚上搜索相关主题时才看到它。如果你也有服务器并且使用<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>的话，我建议你好好读一下那篇文章。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">读完文章之后，我修改了我的<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm</code>选项，如下：</p><pre class="hljs abnf" style="word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;">;&nbsp;Choose&nbsp;how&nbsp;the&nbsp;process&nbsp;manager&nbsp;will&nbsp;control&nbsp;the&nbsp;number&nbsp;of&nbsp;child&nbsp;processes.pm&nbsp;=&nbsp;ondemand
pm.max_children&nbsp;=&nbsp;75pm.process_idle_timeout&nbsp;=&nbsp;10s
pm.max_requests&nbsp;=&nbsp;500</pre><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">最主要的改动就是用<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm=ondemand</code>替换了<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm=dynamic</code>。这一改动对资源占用的影响是巨大的。下面是改动并重新加载<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">php5-fpm</code>之后运行<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">free -mt</code>的结果：</p><pre class="hljs tap" style="word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shared&nbsp;&nbsp;&nbsp;&nbsp;buffers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cached
Mem:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;490&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;196&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;293&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;70
-/+&nbsp;buffers/cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;116&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;373
Swap:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2047&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;452&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1595
Total:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2538&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;649&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1888</pre><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">和之前的结果对比，内存使用量下降了<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">50%</code>。产生这一下降的原因通过执行<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">top</code>命令一目了然：</p><pre class="hljs tap" style="word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;">&nbsp;2778&nbsp;mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;1359152&nbsp;&nbsp;56708&nbsp;&nbsp;&nbsp;3384&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.3&nbsp;&nbsp;&nbsp;2:11.06&nbsp;mysqld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
26896&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;373828&nbsp;&nbsp;19000&nbsp;&nbsp;13532&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;3.8&nbsp;&nbsp;&nbsp;:02.42&nbsp;php5-fpm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25818&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64208&nbsp;&nbsp;&nbsp;4148&nbsp;&nbsp;&nbsp;1492&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;:01.88&nbsp;php5-fpm
25818&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64208&nbsp;&nbsp;&nbsp;4148&nbsp;&nbsp;&nbsp;1492&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;:01.88&nbsp;php5-fpm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
17385&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64208&nbsp;&nbsp;&nbsp;4068&nbsp;&nbsp;&nbsp;1416&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;:02.23&nbsp;php5-fpm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1465&nbsp;ossec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15592&nbsp;&nbsp;&nbsp;2960&nbsp;&nbsp;&nbsp;&nbsp;480&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.6&nbsp;&nbsp;&nbsp;:08.60&nbsp;ossec-analysisd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;1500&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6312&nbsp;&nbsp;&nbsp;2072&nbsp;&nbsp;&nbsp;&nbsp;328&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.4&nbsp;&nbsp;&nbsp;:45.55&nbsp;ossec-syscheckd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33444&nbsp;&nbsp;&nbsp;1940&nbsp;&nbsp;&nbsp;&nbsp;812&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.4&nbsp;&nbsp;&nbsp;:03.29&nbsp;init</pre><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">你注意到这里已经没有子进程了吗？它们去哪里了？这就是设置<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm=ondemand</code>的作用。这样设置之后，只有当有需要的时候，子进程才会被产生。事情做完之后，子进程会留在内存中<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">10</code>秒钟时间（<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">pm.process_idle_timeout = 10s</code>），然后自己退出。</p><p style="word-wrap: break-word; margin-top: 1.5em; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);">我只是对<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>的配置做了一点小小的修改，就节省了<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">50%</code>的内存。当然，这台服务器没有承受大并发的压力，但我相信它能顶得住合理的高负载，考虑到它只有<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">512M</code>内存。再加上<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">Nginx</code>微缓存的配置，我想它会做的更好。当然还有另外一些<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">PHP-FPM</code>和<code style="word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);">Percona MySQL</code>的配置优化我还没有做。这里只是给大家分享一个我觉得非常有用的小窍门。</p><p><br/></p>',
  'is_tui' => '1',
  'status' => '1',
  'views' => '1',
  'auth' => '韩会强',
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000291s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000878s ]
[ sql ] [ SQL ] INSERT INTO `think_article` (`title` , `cate_id` , `type` , `keyword` , `remark` , `content` , `is_tui` , `status` , `views` , `auth` , `photo` , `ip` , `update_time` , `create_time`) VALUES ('如何减少PHP-FPM的内存占用' , 17 , 0 , 'PHP-FPM,内存' , 'PHP-FPM是PHP的FastCGI过程管理器。在类Unix操作系统（包括Linux以及BSD系统）中，PHP-FPM通过安装php5-fpm(Linux)或者php56-fpm(FreeBSD 10.1)来使用。但是缺省安装以及按照大量博客推荐安装的PHP-FPM的最大问题是 ...' , '<p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\"><code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>是<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP</code>的<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">FastCGI</code>过程管理器。在类<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">Unix</code>操作系统（包括<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">Linux</code>以及<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">BSD</code>系统）中，<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>通过安装<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">php5-fpm</code>(<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">Linux</code>)或者<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">php56-fpm</code>(<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">FreeBSD 10.1</code>)来使用。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">但是缺省安装以及按照大量博客推荐安装的<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>的最大问题是它会消耗大量资源，包括内存和<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">CPU</code>。本博客使用的服务器也遭遇了类似的命运。因为我也是按照那些教程安装的，而教程里对于<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>的配置选项描述的不够有效。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">你可以在<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">/etc/php5/fpm/pool.d</code>目录下发现这些低效的配置选项。举例来说，以下是我的服务器（当然不是目前这个站点）上的那些低效选项：</p><pre class=\"hljs lsl\" style=\"word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;\">;&nbsp;Choose&nbsp;how&nbsp;the&nbsp;process&nbsp;manager&nbsp;will&nbsp;control&nbsp;the&nbsp;number&nbsp;of&nbsp;child&nbsp;processes.\r\npm&nbsp;=&nbsp;dynamic\r\npm.max_children&nbsp;=&nbsp;75pm.start_servers&nbsp;=&nbsp;10pm.min_spare_servers&nbsp;=&nbsp;5pm.max_spare_servers&nbsp;=&nbsp;20pm.max_requests&nbsp;=&nbsp;500</pre><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">那台服务器是一台<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">DigitalOcean Droplet</code>，配置<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">512M</code>内存。它上面运行了一个新网站，即使完全空闲时，也必须要靠交换内存才能避免僵死。执行<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">top</code>命令显示了服务器上占用内存最多的进程。</p><pre class=\"hljs tap\" style=\"word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;\">&nbsp;&nbsp;PID&nbsp;USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR&nbsp;&nbsp;NI&nbsp;&nbsp;&nbsp;&nbsp;VIRT&nbsp;&nbsp;&nbsp;&nbsp;RES&nbsp;&nbsp;&nbsp;&nbsp;SHR&nbsp;S&nbsp;%CPU&nbsp;%MEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIME+&nbsp;COMMAND\r\n13891&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396944&nbsp;&nbsp;56596&nbsp;&nbsp;33416&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.3&nbsp;&nbsp;&nbsp;:14.05&nbsp;php5-fpm\r\n13889&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396480&nbsp;&nbsp;56316&nbsp;&nbsp;32916&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.2&nbsp;&nbsp;&nbsp;:17.67&nbsp;php5-fpm\r\n13887&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;624212&nbsp;&nbsp;55088&nbsp;&nbsp;32008&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.0&nbsp;&nbsp;&nbsp;:14.02&nbsp;php5-fpm\r\n13890&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396384&nbsp;&nbsp;55032&nbsp;&nbsp;32312&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.0&nbsp;&nbsp;&nbsp;:13.39&nbsp;php5-fpm\r\n13888&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;397056&nbsp;&nbsp;54972&nbsp;&nbsp;31988&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.0&nbsp;&nbsp;&nbsp;:14.16&nbsp;php5-fpm\r\n14464&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;397020&nbsp;&nbsp;54696&nbsp;&nbsp;31832&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:09.44&nbsp;php5-fpm\r\n13892&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396640&nbsp;&nbsp;54704&nbsp;&nbsp;31936&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:12.84&nbsp;php5-fpm\r\n&nbsp;\r\n13883&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396864&nbsp;&nbsp;54692&nbsp;&nbsp;31940&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:15.64&nbsp;php5-fpm\r\n13893&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396860&nbsp;&nbsp;54628&nbsp;&nbsp;32004&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.9&nbsp;&nbsp;&nbsp;:15.13&nbsp;php5-fpm\r\n13885&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;396852&nbsp;&nbsp;54412&nbsp;&nbsp;32116&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.8&nbsp;&nbsp;&nbsp;:13.94&nbsp;php5-fpm\r\n13884&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;395164&nbsp;&nbsp;53916&nbsp;&nbsp;32364&nbsp;S&nbsp;&nbsp;0.0&nbsp;10.7&nbsp;&nbsp;&nbsp;:13.51&nbsp;php5-fpm\r\n13989&nbsp;cont&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;394960&nbsp;&nbsp;53548&nbsp;&nbsp;32108&nbsp;S&nbsp;&nbsp;3.7&nbsp;10.7&nbsp;&nbsp;&nbsp;:14.37&nbsp;php5-fpm\r\n2778&nbsp;mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;1359152&nbsp;&nbsp;31704&nbsp;&nbsp;&nbsp;1728&nbsp;S&nbsp;&nbsp;0.7&nbsp;&nbsp;6.3&nbsp;&nbsp;&nbsp;1:38.80&nbsp;mysqld\r\n&nbsp;\r\n13849&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;373832&nbsp;&nbsp;&nbsp;1180&nbsp;&nbsp;&nbsp;&nbsp;188&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.2&nbsp;&nbsp;&nbsp;:03.27&nbsp;php5-fpm</pre><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">输出结果显示有<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">12</code>个<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">php5-fpm</code>子进程（用户名是<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">cont</code>）和一个主进程（用户名是<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">root</code>）。而这<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">12</code>个子进程只是呆坐在那里，什么事也不做，每个子进程白白消耗超过<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">10%</code>的内存。这些子进程主要是由<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm=dynamic</code>这个配置选项产生的。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">老实说，绝大部分的云主机拥有者也不知道所有这些配置选项是干什么用的，只是简单地复制粘贴而已。我也不准备假装我了解每个<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP</code>配置文件里的每一个选项的目的和意义。我在很大程度上也是复制粘贴的受害者。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">但是我经常检查服务器的资源占用情况，困惑于为什么我的服务器占用这么多的内存和<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">CPU</code>。举另外一个例子，是这台服务器上的<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">free -mt</code>命令的结果：</p><pre class=\"hljs tap\" style=\"word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shared&nbsp;&nbsp;&nbsp;&nbsp;buffers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cached\r\nMem:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;490&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;480&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;79\r\n-/+&nbsp;buffers/cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;393&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96\r\nSwap:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2047&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;491&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1556\r\nTotal:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2538&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;971&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1566</pre><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">在没有任何访问量的情况下，也几乎有整整<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">1G</code>的内存（实际内存加上交换内存）被占用。当然，通过调整配置<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm</code>的数量可以有所改变，但只是轻微的。只要设置<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm=dynamic</code>，就会有空闲的子进程等在那里等待被使用。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">直到读了一篇文章《<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">A better way to run PHP-FPM</code>》(更好地运行<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>)之后，我开始意识到应该如何修改我的配置文件。那篇文章是大约一年前写的，令人失望的是我从昨天晚上搜索相关主题时才看到它。如果你也有服务器并且使用<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>的话，我建议你好好读一下那篇文章。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">读完文章之后，我修改了我的<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm</code>选项，如下：</p><pre class=\"hljs abnf\" style=\"word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;\">;&nbsp;Choose&nbsp;how&nbsp;the&nbsp;process&nbsp;manager&nbsp;will&nbsp;control&nbsp;the&nbsp;number&nbsp;of&nbsp;child&nbsp;processes.pm&nbsp;=&nbsp;ondemand\r\npm.max_children&nbsp;=&nbsp;75pm.process_idle_timeout&nbsp;=&nbsp;10s\r\npm.max_requests&nbsp;=&nbsp;500</pre><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">最主要的改动就是用<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm=ondemand</code>替换了<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm=dynamic</code>。这一改动对资源占用的影响是巨大的。下面是改动并重新加载<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">php5-fpm</code>之后运行<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">free -mt</code>的结果：</p><pre class=\"hljs tap\" style=\"word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shared&nbsp;&nbsp;&nbsp;&nbsp;buffers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cached\r\nMem:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;490&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;196&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;293&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;70\r\n-/+&nbsp;buffers/cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;116&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;373\r\nSwap:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2047&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;452&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1595\r\nTotal:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2538&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;649&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1888</pre><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">和之前的结果对比，内存使用量下降了<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">50%</code>。产生这一下降的原因通过执行<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">top</code>命令一目了然：</p><pre class=\"hljs tap\" style=\"word-wrap: break-word; padding: 1em; margin-bottom: 1.5em; font-size: 0.93em; background-color: rgb(255, 255, 255); border-radius: 4px; border: currentcolor; color: rgb(51, 51, 51); line-height: 1.45; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; position: relative; max-height: 35em; box-sizing: border-box; margin-top: 0px !important;\">&nbsp;2778&nbsp;mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;1359152&nbsp;&nbsp;56708&nbsp;&nbsp;&nbsp;3384&nbsp;S&nbsp;&nbsp;0.0&nbsp;11.3&nbsp;&nbsp;&nbsp;2:11.06&nbsp;mysqld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n26896&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;373828&nbsp;&nbsp;19000&nbsp;&nbsp;13532&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;3.8&nbsp;&nbsp;&nbsp;:02.42&nbsp;php5-fpm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25818&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64208&nbsp;&nbsp;&nbsp;4148&nbsp;&nbsp;&nbsp;1492&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;:01.88&nbsp;php5-fpm\r\n25818&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64208&nbsp;&nbsp;&nbsp;4148&nbsp;&nbsp;&nbsp;1492&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;:01.88&nbsp;php5-fpm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n17385&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64208&nbsp;&nbsp;&nbsp;4068&nbsp;&nbsp;&nbsp;1416&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.8&nbsp;&nbsp;&nbsp;:02.23&nbsp;php5-fpm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1465&nbsp;ossec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15592&nbsp;&nbsp;&nbsp;2960&nbsp;&nbsp;&nbsp;&nbsp;480&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.6&nbsp;&nbsp;&nbsp;:08.60&nbsp;ossec-analysisd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;1500&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6312&nbsp;&nbsp;&nbsp;2072&nbsp;&nbsp;&nbsp;&nbsp;328&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.4&nbsp;&nbsp;&nbsp;:45.55&nbsp;ossec-syscheckd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33444&nbsp;&nbsp;&nbsp;1940&nbsp;&nbsp;&nbsp;&nbsp;812&nbsp;S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.4&nbsp;&nbsp;&nbsp;:03.29&nbsp;init</pre><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">你注意到这里已经没有子进程了吗？它们去哪里了？这就是设置<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm=ondemand</code>的作用。这样设置之后，只有当有需要的时候，子进程才会被产生。事情做完之后，子进程会留在内存中<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">10</code>秒钟时间（<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">pm.process_idle_timeout = 10s</code>），然后自己退出。</p><p style=\"word-wrap: break-word; margin-top: 1.5em; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); white-space: normal; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; box-sizing: border-box; background-color: rgb(255, 255, 255);\">我只是对<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>的配置做了一点小小的修改，就节省了<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">50%</code>的内存。当然，这台服务器没有承受大并发的压力，但我相信它能顶得住合理的高负载，考虑到它只有<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">512M</code>内存。再加上<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">Nginx</code>微缓存的配置，我想它会做的更好。当然还有另外一些<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">PHP-FPM</code>和<code style=\"word-wrap: break-word; font-size: 0.93em; padding: 2px 4px; border-radius: 4px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; box-sizing: border-box; background-color: rgb(249, 242, 244);\">Percona MySQL</code>的配置优化我还没有做。这里只是给大家分享一个我觉得非常有用的小窍门。</p><p><br/></p>' , 1 , 1 , 1 , '韩会强' , 'images/j5umlhns_4yw0b8isxos959816fb99fb29.jpg' , '123.233.116.122' , 1501654969 , 1501654969) [ RunTime:0.004321s ]

---------------------------------------------------------------
[ 2017-08-02T14:22:51+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] hhqblog.com/admin/article/index.html [运行时间：0.026142s][吞吐率：38.25req/s] [内存消耗：3,585.30kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000303s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000843s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000154s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000617s ]

---------------------------------------------------------------
[ 2017-08-02T14:22:51+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.029355s][吞吐率：34.07req/s] [内存消耗：3,516.39kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000304s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000834s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000164s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000672s ]

---------------------------------------------------------------
[ 2017-08-02T14:22:59+08:00 ] 172.17.180.47 123.233.116.122 GET /
[ log ] hhqblog.com/ [运行时间：0.033068s][吞吐率：30.24req/s] [内存消耗：4,697.13kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000283s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000778s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000648s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000375s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000362s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000321s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000261s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000479s ]

---------------------------------------------------------------
[ 2017-08-02T14:23:00+08:00 ] 172.17.180.47 123.233.116.122 GET /index/index/index.html?page=1
[ log ] hhqblog.com/index/index/index.html?page=1 [运行时间：0.033243s][吞吐率：30.08req/s] [内存消耗：4,715.82kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.1.1500952368.1500950707.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000326s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000875s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000597s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000414s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000284s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000563s ]

---------------------------------------------------------------
[ 2017-08-02T14:27:54+08:00 ] 172.17.180.47 180.76.15.29 GET /ar/36
[ log ] www.hhqblog.com/ar/36 [运行时间：0.030938s][吞吐率：32.32req/s] [内存消耗：4,115.92kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-encoding' => 'gzip',
  'accept-language' => 'en-US',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '36',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000304s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000855s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000520s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 36 LIMIT 1 [ RunTime:0.000284s ]

---------------------------------------------------------------
[ 2017-08-02T14:35:16+08:00 ] 172.17.180.47 123.233.116.122 GET /admin
[ log ] hhqblog.com/admin [运行时间：0.015653s][吞吐率：63.88req/s] [内存消耗：1,977.98kb] [文件加载：44]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Index->index[ /yjdata/www/hhqblog/application/admin/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/public/index.html [ array (
) ]
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:35:16+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/index/main.html
[ log ] hhqblog.com/admin/index/main.html [运行时间：0.015818s][吞吐率：63.22req/s] [内存消耗：1,900.90kb] [文件加载：43]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'index',
    2 => 'main',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Index->main[ /yjdata/www/hhqblog/application/admin/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/index/index.html [ array (
  0 => 'info',
) ]
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:35:20+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] hhqblog.com/admin/article/index.html [运行时间：0.027124s][吞吐率：36.87req/s] [内存消耗：3,585.38kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000334s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000844s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000159s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000629s ]

---------------------------------------------------------------
[ 2017-08-02T14:35:20+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.028997s][吞吐率：34.49req/s] [内存消耗：3,516.73kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000340s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000816s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000156s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000613s ]

---------------------------------------------------------------
[ 2017-08-02T14:35:21+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/add_article.html
[ log ] hhqblog.com/admin/article/add_article.html [运行时间：0.022811s][吞吐率：43.84req/s] [内存消耗：2,987.01kb] [文件加载：51]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/add_article.html [ array (
  0 => 'cates',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000309s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article_cate` [ RunTime:0.000767s ]
[ sql ] [ SQL ] SELECT `id`,`name` FROM `think_article_cate` [ RunTime:0.000195s ]

---------------------------------------------------------------
[ 2017-08-02T14:37:05+08:00 ] 172.17.180.47 123.233.116.122 POST /admin/article/add_article.html
[ log ] hhqblog.com/admin/article/add_article.html [运行时间：0.339189s][吞吐率：2.95req/s] [内存消耗：4,513.97kb] [文件加载：61]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'content-length' => '388099',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://hhqblog.com',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'content-type' => 'multipart/form-data; boundary=----WebKitFormBoundaryd1kipDX7r5bnQlP5',
  'referer' => 'http://hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
)
[ info ] [ PARAM ] array (
  'title' => 'show engine innodb status解读',
  'cate_id' => '22',
  'type' => '0',
  'keyword' => 'mysql 解读 ',
  'remark' => 'innodb存储引擎在show engine innodb status（老版本对应的是show innodb status）输出中，显示除了大量的内部信息，它输出就是一个单独的字符串，没有行和列，内容分为很多小段，每一段对应innodb存储引擎不同部分的信息，其中有一些信息对于innodb开发者来说非常有用，但是，许多信息，如果你尝试去理解，并且应用到高性能innodb调优的时候，你会发现它们非常有趣，甚至是非常有必要的。',
  'content' => '<p><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">注：以下内容为根据《高性能mysql第三版》和《mysql技术内幕innodb存储引擎》的innodb status部分的个人理解，如果有错误，还望指正！！</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">　　innodb存储引擎在show engine innodb status（老版本对应的是show innodb status）输出中，显示除了大量的内部信息，它输出就是一个单独的字符串，没有行和列，内容分为很多小段，每一段对应innodb存储引擎不同部分的信息，其中有一些信息对于innodb开发者来说非常有用，但是，许多信息，如果你尝试去理解，并且应用到高性能innodb调优的时候，你会发现它们非常有趣，甚至是非常有必要的。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">输出内容中包含了一些平均值的统计信息，这些平均值是自上次输出结果生成以来的统计数，因此，如果你正在检查这些值，那就要确保已经等待了至少30s的时间，使两次采样之间的积累足够长的统计时间并多次采样，检查计数器变化从而弄清其行为，并不是所有的输出都会在一个时间点上生成，因而也不是所有的显示出来的平均值会在同一时间间隔里重新再计算。而且，innodb有一个内部复位间隔，而它是不可预知的，各个版本也不一样。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">这些输出信息足够提供给手工计算出大多数你想要的统计信息，有一款监控工具innotop可以帮你计算出增量差值和平均值。下面，在你的mysql命令行敲下show engine innodb status;看着输出跟着下面的步骤一步一步理解输出信息是什么含义：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">注意：以下使用mysql5.5.24版本做解读，mysql5.6.x和5.7.x输出内容有些地方有调整。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1.第一段是头部信息，它仅仅声明了输出的开始，其内容包括当前的日期和时间，以及自上次输出以来经过的时长。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">=====================================</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">160129 12:07:26 INNODB MONITOR OUTPUT&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#第二行是当前日期和时间</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">=====================================</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Per second averages calculated from the last 24 seconds</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#第四行显示的是计算出这一平均值的时间间隔，即自上次输出以来的时间，或者是距上次内部复位的时长</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2.从innodb1.0.x开始，可以使用命令show engine innodb status;来查看master thread的状态信息:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">-----------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">BACKGROUND THREAD</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">-----------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">srv_master_thread loops: 30977173 1_second, 30975685 sleeps, 3090359 10_second, 166112 background, 165988 flush&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示主循环进行了30977173 1_second次，每秒挂起的操作进行了30975685 sleeps次（说明负载不是很大），10秒一次的活动进行了3090359 10_second次，1秒循环和10秒循环比值符合1：10，backgroup loop进行了166112 background次，flush loop进行了165988 flush次，如果在一台很大压力的mysql上，可能看到每秒运行次数和挂起次数比例小于1很多，这是因为innodb对内部进行了一些优化，当压力大时间隔时间并不总是等待1秒，因此，不能认为每秒循环和挂起的值总是相等，在某些情况下，可以通过两者之间的差值来比较反映当前数据库的负载压力。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">srv_master_thread log flush and writes: 31160103</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3.如果有高并发的工作负载，你就要关注下接下来的段（SEMAPHORES信号量）,它包含了两种数据：事件计数器以及可选的当前等待线程的列表，如果有性能上的瓶颈，可以使用这些信息来找出瓶颈，不幸的是，想知道怎么使用这些信息还是有一点复杂，下面先给出一些解释：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">SEMAPHORES</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">OS WAIT ARRAY INFO: reservation count 68581015, signal count 218437328&nbsp;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--Thread 140653057947392 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">S-lock on RW-latch at 0x7ff536c7d3c0 created in file buf0buf.c line 916</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">a writer (thread id 140653057947392) has reserved it in mode exclusive</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">number of readers 0, waiters flag 1, lock_word: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time read locked in file row0sel.c line 3097</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--Thread 140653677291264 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">S-lock on RW-latch at 0x7ff53945b240 created in file buf0buf.c line 916</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">a writer (thread id 140653677291264) has reserved it in mode exclusive</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">number of readers 0, waiters flag 1, lock_word: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time read locked in file row0sel.c line 3097</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Mutex spin waits 1157217380, rounds 1783981614, OS waits 10610359</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RW-shared spins 103830012, rounds 1982690277, OS waits 52051891</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RW-excl spins 43730722, rounds 602114981, OS waits 3495769</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Spin rounds per wait: 1.54 mutex, 19.10 RW-shared, 13.77 RW-excl</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">内容比较多，下面分段依次解释：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3.1.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">OS WAIT ARRAY INFO: reservation count 68581015, signal count 218437328&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行给出了关于操作系统等待数组的信息，它是一个插槽数组，innodb在数组里为信号量保留了一些插槽，操作系统用这些信号量给线程发送信号，使线程可以继续运行，以完成它们等着做的事情，这一行还显示出innodb使用了多少次操作系统的等待：保留统计（reservation count）显示了innodb分配插槽的频度，而信号</strong><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">计数（signal count）衡量的是线程通过数组得到信号的频度，操作系统的等待相对于空转等待（spin wait）要昂贵些。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3.2.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--Thread 140653057947392 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">S-lock on RW-latch at 0x7ff536c7d3c0 created in file buf0buf.c line 916</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">a writer (thread id 140653057947392) has reserved it in mode exclusive</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">number of readers 0, waiters flag 1, lock_word: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time read locked in file row0sel.c line 3097</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--Thread 140653677291264 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">S-lock on RW-latch at 0x7ff53945b240 created in file buf0buf.c line 916</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">a writer (thread id 140653677291264) has reserved it in mode exclusive</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">number of readers 0, waiters flag 1, lock_word: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time read locked in file row0sel.c line 3097</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">这部分显示的是当前正在等待互斥量的innodb线程，在这里可以看到有两个线程正在等待，每一个都是以--Thread &lt;数字&gt; has waited...开始，这一段内容在正常情况下应该是空的（即查看的时候没有这部分内容），除非服务器运行着高并发的工作负载，促使innodb采取让操作系统等待的措施，除非你对innodb源码熟悉，否则这里看到的最有用的信息就是发生线程等待的代码文件名 /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">在innodb内部哪里才是热点？举例来说，如果看到许多线程都在一个名为buf0buf.c的文件上等待，那就意味着你的系统里存在着</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">缓冲池竞争，这个输出信息还显示了这些线程等待了多少时间，其中waiters flag显示了有多少个等待着正在等待同一个互斥量。 如果waiters flag为0那就表示没有线程在等待同一个互斥量（此时在waiters flag 0后面可能可以看到wait is ending，表示这个互斥量已经被释放了，但操作系统还没有把线程调度过来运行）。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">你可能想知道innodb真正等待的是什么，innodb使用了互斥量和信号量来保护代码的临界区，如：限定每次只能有一个线程进入临界区，或者是当有活动的读时，就限制写入等。在innodb代码里有很多临界区，在合适的条件下，它们都可能出现在那里，常常能见到的一种情形是：获取缓冲池分页的访问权的时候。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3.3.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">在等待线程之后的部分信息如下，这部分显示了更多的事件计数器，在每一个情形中，都能看到innodb依靠操作系统等待的频度：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Mutex spin waits 1157217380, rounds 1783981614, OS waits 10610359</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示的是跟互斥量相关的几个计数器</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RW-shared spins 103830012, rounds 1982690277, OS waits 52051891&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示读写的共享锁的计数器</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RW-excl spins 43730722, rounds 602114981, OS waits 3495769&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示读写的排他锁的计数器</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Spin rounds per wait: 1.54 mutex, 19.10 RW-shared, 13.77 RW-excl</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">innodb有着一个多阶段等待的策略，首先，它会试着对锁进行空转等待，如果经历了一个预设的空转等待周期（设置innodb_sync_spin_loops配置变量命令）之后还没有成功，那就会退到更昂贵更复杂的等待数组中。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">空转等待的成本相对较低，但是它们要不停地检查一个资源能否被锁定，这种方式会消耗CPU周期，但是，这没有听起来那么糟糕，因为当处理器在等待IO时，一般都有一些空闲的CPU周期可用，即使是没有空闲的CPU周期，空等也要比其他方式更加廉价一些。然而，当另外一个线程能做一些事情的时候，空转等待也还会把CPU独占着。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">空转等待的替代方案就是让操作系统做上下文切换，这样，当一个线程在等待时，另外一个线程就可以被运行，然后，通过等待数组里的信号量发出信号，唤醒那个沉睡的线程，通过信号量来发送信号是比较有效的，但是上下文切换就很昂贵，这很快就会积少成多，每秒钟几千次的切换会引发大量的系统开销。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">你可以通过修改innodb_sync_spin_loops的值，试着在空转等待与操作系统等待之间达成平衡，不要担心空转等待，除非你在一秒里看到几十万个空转等待。此时，你可以考虑performance_schema库或者show engine innodb mutex;查看下相关信息。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4.下面这一段外键错误的信息一般不会出现，除非你服务器上发生了外键错误，有时问题在于事务在插入，更新或删除一条记录时要寻找父表或子表，还有时候是当innodb尝试增加或删除一个外键或者修改一个已经存在的外键时，发现表之间类型不匹配，这部分输出对于调试与innodb不明确的外键错误发生的准确原因非常有帮助，下面搞一个示例来看看：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4.1 创建父表：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; create table parent(parent_id int not null,primary key(parent_id)) engine=innodb;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4.2 创建子表：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; create table child(child_id int not null,key child_id(child_id),constraint i_child foreign key(child_id) references parent(parent_id)) engine=innodb;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4.3 插入数据：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; insert into parent(parent_id) values(1);</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; insert into child(child_id) values(1);</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4.5 有两种基本的外键错误：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">第一种：以某种可能违反外键约束关系的方法增加，更新，删除数据，将导致第一类错误，如，在父表中删除行时发生如下错误：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; delete from parent;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`xiaoboluo`.`child`, CONSTRAINT `i_child` FOREIGN KEY (`child_id`) REFERENCES `parent` (`parent_id`))</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">错误信息相当明了，对所有由增加，删除，更新不匹配的行导致的错误都会看到相似的信息，下面是show engine innodb status的输出：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LATEST FOREIGN KEY ERROR</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">160128 1:17:06 Transaction:&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了最近一次外键错误的日期和时间</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTION D203D6, ACTIVE 0 sec updating or deleting</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4 lock struct(s), heap size 1248, 2 row lock(s), undo log entries 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1813996 localhost root updating</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">delete from parent</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Foreign key constraint fails for table `xiaoboluo`.`child`:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">,</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#上面部分显示了关于破坏外键约束的事务详情。后边部分显示了发现错误时innodb正尝试修改的准确数据，输出中有许多是转换成可打印格式的行数据</strong><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">CONSTRAINT `i_child` FOREIGN KEY (`child_id`) REFERENCES `parent` (`parent_id`)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trying to delete or update in parent table, in index `PRIMARY` tuple:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">DATA TUPLE: 3 fields;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 80000001; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d203d6; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex 1e000001ca0110; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">But in child table `xiaoboluo`.`child`, in index `child_id`, there is a record:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">PHYSICAL RECORD: n_fields 2; compact format; info bits 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 80000001; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000013a99b3e; asc &gt;;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">4.6 第二种：尝试修改父表的表结构时发生的错误，这种错误就没有那么清楚了，这可能会让调试更困难：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; alter table parent modify parent_id int unsigned not null;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">ERROR 1025 (HY000): Error on rename of &#39;./xiaoboluo/#sql-b695_4e3b&#39; to &#39;./xiaoboluo/parent&#39; (errno: 150)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">查看show engine innodb status输出信息：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LATEST FOREIGN KEY ERROR</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">160128 1:32:33 Error in foreign key constraint of table xiaoboluo/child:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">there is no index in referenced table which would contain</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">the columns as the first columns, or the data types in the</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">referenced table do not match the ones in table. Constraint:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">,</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">CONSTRAINT &quot;i_child&quot; FOREIGN KEY (&quot;child_id&quot;) REFERENCES &quot;parent&quot; (&quot;parent_id&quot;)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">The index in the foreign key in table is &quot;child_id&quot;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">See&nbsp;</span><a href="http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html" target="_blank" style="margin: 0px; padding: 0px; color: black; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html</a><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">for correct foreign key definition.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">InnoDB: Renaming table `xiaoboluo`.&lt;result 2 when explaining filename &#39;#sql-b695_4e3b&#39;&gt; to `xiaoboluo`.`parent` failed!</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">上面的错误是数据类型不匹配，外键列必须有完全相同的数据类型，包括任何的修饰符（如这里父表多加了一个unsigned，这也是问题所在），当看到1025错误并不理解为什么时，最好查看下innodb status。在每次看到有新错误时，外键错误信息都会被重写，percona toolkit中的pt-fk-error-logger工具可以用表保存这些信息以供后续分析。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.与外键错误一样，这部分只有当服务器产生死锁时才会出现，死锁信息同样在每次有新的死锁错误时被重写，percona toolkit中的pt-deadlock-logger工具可以用表保存这些信息以供后续分析</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">死锁在等待关系图里是一个循环，就是一个锁定了行的数据结构又在等待别的锁，这个循环可以任意地大，innodb会立即检测到死锁，因为每当有事务等待行锁的时候，它都会去检查等待关系图里是否有循环，死锁的情况可能会比较复杂，但是，这一部分只显示了最近的两个死锁的情况，它们在各自的事务里执行的最后一条语句，以及它们在等待关系图里形成环锁的信息。在这个循环里你看不到其他事务，也可能看不到在事务里早先真正获得了锁的语句，尽管如此，通常还是可以通过查看这些输出结果来确定到底是什么引起了死锁。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">在innodb里实际上有两种死锁，第一种就是常常碰到的那种，它在等待关系图里是一个真正的循环，另外一种就是在一个等待关系图里，因代价昂贵而无法检测它是不是包含了循环，如果innodb要在关系图里检查超过100W个锁，或者在检查过程中，innodb要重做200个以上的事务，那它会放弃，并宣布这里有一个死锁，这些数值都是硬编码在innodb代码里的常量，无法配置（如果你NB可以修改代码然后重新编译）。第二种死锁报错你可以在输出里看到一条信息：TOO DEEP OR LONG SEARCH IN THE LOCK TABLE WAITS-FOR GRAPH</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">innodb不仅会打印出事务和事务持有和等待的锁，而且还有记录本身，不幸的是，它至于可能超过为输出结果预留的长度（只能打印1M的内容且只能保留最近一次的死锁信息），如果你无法看到完整的输出，此时可以在任意库下创建innodb_monitor或innodb_lock_monitor表，这样innodb status信息会完整且每15s一次被记录到错误日志中。如：create table innodb_monitor(a int)engine=innodb;，不需要记录到错误日志中时就删掉这个表即可。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1 下面也搞一个示例来看看：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1.1 建表：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; create table test_deadlock(id int unsigned not null primary key auto_increment,test int unsigned not null);</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Query OK, 0 rows affected (0.02 sec)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1.2 插入测试数据：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; insert into test_deadlock(test) values(1),(2),(3),(4),(5);</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Query OK, 5 rows affected (0.00 sec)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Records: 5 Duplicates: 0 Warnings: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">打开两个会话终端：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1.3 会话1执行下面的SQL：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; set autocommit=0;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Query OK, 0 rows affected (0.00 sec)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; select * from test_deadlock where id=1 for update;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">+----+------+</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">| id | test |</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">+----+------+</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">| 1 | 1 |</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">+----+------+</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1 row in set (0.00 sec)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1.4 接着会话2执行下面的SQL：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; set autocommit=0;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Query OK, 0 rows affected (0.00 sec)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; select * from test_deadlock where id=2 for update;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">+----+------+</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">| id | test |</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">+----+------+</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">| 2 | 2 |</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">+----+------+</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1 row in set (0.00 sec)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1.5 回到会话1执行下面的SQL，会发生等待：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; select * from test_deadlock where id=2 for update;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.1.6 回到会话2执行下面的SQL，产生死锁，会话2被回滚：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql&gt; select * from test_deadlock where id=1 for update;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.2 查看innodb status信息：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LATEST DETECTED DEADLOCK</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">160128 1:51:53&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这里显示了最近一次发生死锁的日期和时间</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (1) TRANSACTION:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTION D20847, ACTIVE 141 sec starting index read</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LOCK WAIT 3 lock struct(s), heap size 376, 2 row lock(s)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1818124 localhost root statistics</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select * from test_deadlock where id=2 for update</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20847 lock_mode X locks rec but not gap waiting</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab011d; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (2) TRANSACTION:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTION D20853, ACTIVE 119 sec starting index read</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3 lock struct(s), heap size 1248, 2 row lock(s)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 20081, OS thread handle 0x7f0a0f020700, query id 1818204 localhost root statistics</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select * from test_deadlock where id=1 for update</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (2) HOLDS THE LOCK(S):</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab011d; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap waiting</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 2 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000001; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab0110; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000001; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** WE ROLL BACK TRANSACTION (2)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">这部分内容比较多，下面分段逐一进行解释：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.2.1 下面这部分显示的是死锁的第一个事务的信息：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (1) TRANSACTION:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTION D20847, ACTIVE 141 sec starting index read</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LOCK WAIT 3 lock struct(s), heap size 376, 2 row lock(s)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1818124 localhost root statistics</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select * from test_deadlock where id=2 for update</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTION D20847, ACTIVE 141 sec starting index read：</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">这行表示事务D20847，ACTIVE 141 sec表示事务处于活跃状态141s，starting index read表示正在使用索引读取数据行</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 1</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行表示事务D20847正在使用1个表，且涉及锁的表有1个</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LOCK WAIT 3 lock struct(s), heap size 376, 2 row lock(s)</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行表示在等待3把锁，占用内存376字节，涉及2行记录，如果事务已经锁定了几行数据，这里将会有一行信息显示出锁定结构的数目（注意，这跟行锁是两回事）和堆大小，堆的大小指的是为了持有这些行锁而占用的内存大小，Innodb是用一种特殊的位图表来实现行锁的，从理论上讲，它可将每一个锁定的行表示为一个比特，经测试显示，每个锁通常不超过4比特</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1818124 localhost root statistics</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行表示该事务的线程ID信息，操作系统句柄信息，连接来源、用户</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select * from test_deadlock where id=2 for update&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行表示事务涉及的SQL</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.2.2 下面这一部分显示的是当死锁发生时，第一个事务正在等待的锁等信息：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行信息表示第一个事务正在等待锁被授予</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20847 lock_mode X locks rec but not gap waiting</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab011d; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20847 lock_mode X locks rec but not gap waiting</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行信息表示等待的锁是一个record lock，空间id是441，页编号为3，大概位置在页的72位处，锁发生在表xiaoboluo.test_deadlock的主键上，是一个X锁，但是不是gap lock。 waiting表示正在等待锁</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行表示record lock的heap no 位置</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这部分剩下的内容只对调试才有用。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab011d; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.2.3 下面这部分是事务二的状态：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (2) TRANSACTION:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTION D20853, ACTIVE 119 sec starting index read&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#事务2处于活跃状态119s</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 1&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#正在使用1个表，涉及锁的表有1个</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3 lock struct(s), heap size 1248, 2 row lock(s)&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#涉及3把锁，2行记录</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 20081, OS thread handle 0x7f0a0f020700, query id 1818204 localhost root statistics</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select * from test_deadlock where id=1 for update</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#第二个事务的SQL</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.2.4 下面这部分是事务二的持有锁信息：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (2) HOLDS THE LOCK(S):</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab011d; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000002; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#从这两行持有锁信息计息后面几行调试信息上看，就是事务1正在等待的锁。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5.2.5 下面这部分是事务二正在等待的锁，从下面的信息上看，等待的是同一个表，同一个索引，同一个page上的record lock X锁，但是heap no位置不同，即不同的行上的锁：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap waiting</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Record lock, heap no 2 PHYSICAL RECORD: n_fields 4; compact format; info bits 0&nbsp;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0: len 4; hex 00000001; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1: len 6; hex 000000d20808; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2: len 7; hex ad000001ab0110; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">3: len 4; hex 00000001; asc ;;</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">*** WE ROLL BACK TRANSACTION (2) #这个表示事务2被回滚，因为两个事务的回滚开销一样，所以选择了后提交的事务进行回滚，如果两个事务回滚的开销不同(undo 数量不同)，那么就回滚开销最小的那个事务。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">当一个事务持有了其他事务需要的锁，同时又想获得其他事务持有的锁时，等待关系图上就会产生循环，Innodb不会显示所有持有和等待的锁，但是，它显示了足够的信息来帮你确定，查询操作正在使用哪些索引，这对于你确定能否避免死锁有极大的价值。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">如果能使两个查询对同一个索引朝同一个方向进行扫描，就能降低死锁的数目，因为，查询在同一个顺序上请求锁的时候不会创建循环，有时候，这是很容易做到的，如：要在一个事务里更新许多条记录，就可以在应用程序的内存里把它们按照主键进行排序，然后，再用同样的顺序更新到数据库里，这样就不会有死锁发生，但是在另一些时候，这个方法也是行不通的（如果有两个进程使用了不同的索引区间操作同一张表的时候）。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">6. 下面这部分包含了一些关于innodb事务的总结信息，紧随其后的是当前活跃事务列表，如：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">TRANSACTIONS</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trx id counter 4E0132AD</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Purge done for trx&#39;s n:o &lt; 4E01090B undo n:o &lt; 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">History list length 1853</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LIST OF TRANSACTIONS FOR EACH SESSION:</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0131D3, not started</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208218, OS thread handle 0x7fec7c582700, query id 5274800318 10.207.162.69 gdsser</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E01323F, not started</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208217, OS thread handle 0x7fec7c1b3700, query id 5274800938 10.207.162.69 gdsser</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">....................</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0132AC, ACTIVE 0 sec preparing</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">2 lock struct(s), heap size 376, 1 row lock(s), undo log entries 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208200, OS thread handle 0x7fec567e0700, query id 5274801557 10.207.162.69 gdsser</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">commit</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0110E7, ACTIVE 188 sec</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208154, OS thread handle 0x7fec7c235700, query id 5274800671 10.143.90.228 root Sending data</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowskillpoint`</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trx read view will not see trx with id &gt;= 4E0110E8, sees &lt; 4E0108EE</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0108EF, ACTIVE 233 sec fetching rows</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208131, OS thread handle 0x7fec578e3700, query id 5274801341 10.143.90.228 root Sending data</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowsilver`</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trx read view will not see trx with id &gt;= 4E0108F0, sees &lt; 4E0108EC</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0108EE, ACTIVE 233 sec fetching rows</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208132, OS thread handle 0x7fec7c78a700, query id 5274797797 10.143.90.228 root Sending data</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowmail`</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trx read view will not see trx with id &gt;= 4E0108EF, sees &lt; 4E0108EC</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">这部分内容比较多，下面分段逐一进行解释：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">6.1.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trx id counter 4E0132AD&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行表示当前事务ID，这是一个系统变量，每创建一个新事务都会增加</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Purge done for trx&#39;s n:o &lt; 4E01090B undo n:o &lt; 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这是innodb清除旧MVCC行时所用的事务ID，将这个值和当前事务ID进行比较，就可以知道有多少老版本的数据未被清除。这个数字多大才可以安全的取值没有硬性和速成的规定，如果数据没做过任何更新，那么一个巨大的数字也不意味着有未清除的数据，因为实际上所有事务在数据库里查看的都是同一个版本的数据（此时只是事务ID在增加，而数据没有变更），另一方面，如果有很多行被更新，那每一行就会有一个或多个版本留在内存里，减少此类开销的最好办法就是确保事务已完成就立即提交，不要让它长时间地处于打开状态，因为一个打开的事务即使不做任何操作，也会影响到innodb清理旧版本的行数据。 undo n:o &lt; 0这个是innodb清理进程正在使用的撤销日志编号，为0 0时说明清理进程处于空闲状态。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">History list length 1853&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#历史记录的长度，即位于innodb数据文件的撤销空间里的页面的数目，如果事务执行了更新并提交，这个数字就会增加，而当清理进程移除旧版本数据时，它就会减少，清理进程也会更新Purge done for.....这行中的数值。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">6.2.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">头部信息之后就是一个事务列表，当前版本的mysql还不支持嵌套事务，因此，在某个时间点上，每个客户端连接能够拥有的事务数量是有一个上限的，而且每一个事务只能属于单一连接（即一个事务只能使用单个线程执行，不能使用多个线程）。在输出信息里，每一个事务至少占有两行内容，如：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0131D3, not started</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#每个事务的第一行以事务的ID和状态开始，not started表示这个事务已经提交并且没有再发起影响事务的语句，可能刚好空闲</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208218, OS thread handle 0x7fec7c582700, query id 5274800318 10.207.162.69 gdsser</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#然后每个事务的第二行是一些线程等信息，MySQL thread id &lt;数字&gt;部分和是hi用show full processlist;命令看到的id列相同。紧随其后的是一个内部查询id和一些连接信息，这些信息同样与show full processlist中的输出相同。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E01323F, not started</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208217, OS thread handle 0x7fec7c1b3700, query id 5274800938 10.207.162.69 gdsser</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">6.3.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">上面是not started状态的事务信息，下面来看看为ACTIVE状态的事务信息：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---TRANSACTION 4E0110E7, ACTIVE 188 sec&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示次事务处于活跃状态已经188s，可能的所有状态有not started，active，prepared和committed in memory，一旦事务日志落盘了就会变成not started状态。在时间后面会显示出当前事务正在做什么（在这里为空没有显示出来），在源代码中有超过30个字符串常量可以显示在时间后面，如：fetching，preparing，rows，adding foreign keys等等</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">mysql tables in use 1, locked 0</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#该事务用到的表数和涉及表锁的表数，Innodb一般不会锁定表，但对有些语句会锁定，如果mysql服务器在高于innodb层之上将表锁定，这里也是能够显示出来的，如果事务已经锁定了几行数据，这里将会有一行信息显示出锁定结构的数目（注意，这跟行锁是两回事）和和堆大小，如：2 lock struct(s), heap size 376, 1 row lock(s), undo log entries 1，堆的大小指的是为了持有这些行锁而占用的内存大小，Innodb是用一种特殊的位图表来实现行锁的，从理论上讲，它可将每一个锁定的行表示为一个比特，经测试显示，每个锁通常不超过4比特。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">MySQL thread id 26208154, OS thread handle 0x7fec7c235700, query id 5274800671 10.143.90.228 root Sending data</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#与show processlist输出结果大部分相同</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowskillpoint`&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#如果事务正在运行一个查询，那么这里就会显示事务涉及的SQL，注意：有些版本可能只显示其中一小段，而不是完整的SQL</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Trx read view will not see trx with id &gt;= 4E0110E8, sees &lt; 4E0108EE&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了事务的读视图，它表明了因为版本关系而产生的对于事务可见和不可见两种类型的事务ID的范围，在这里，两个数字之间有一个事务的间隙，这个间隙里的事务可能是不可见的，innodb在执行查询时，对于那些事务ID正好在这个间隙的行，还会检查其可见性。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">注：如果事务正在等待一个锁，那么在查询SQL文本后面将可以看到这个锁的信息，在上文的死锁例子里，这样的信息看到过很多了，不幸的是，输出信息并没有说出这个锁正被其他哪个事务持有，不过可以通过information_schema库下的innodb_trx，innodb_lock_waits，innodb_locks三个表来查明这一点。如果输出信息里有很多个事务，innodb可能会限制要打印出来的事务数目，以免输出信息增长得太大，这时就会看到...truncated...提示。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">7.FILE I/O部分显示的是I/O辅助线程的状态，还有性能计数器的状态，如下：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">FILE I/O</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 0 state: waiting for i/o request (insert buffer thread)&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#insert buffer thread</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 1 state: waiting for i/o request (log thread)&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#log thread</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 2 state: waiting for i/o request (read thread)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 3 state: waiting for i/o request (read thread)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 4 state: waiting for i/o request (read thread)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 5 state: doing file i/o (read thread) ev set&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#以上为默认的4个read thread</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 6 state: waiting for i/o request (write thread)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 7 state: waiting for i/o request (write thread)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 8 state: waiting for i/o request (write thread)</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O thread 9 state: waiting for i/o request (write thread)</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#以上为默认的4个write thread</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending normal aio reads: 128 [0, 0, 0, 128] , aio writes: 0 [0, 0, 0, 0] ,&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#读线程和写线程挂起操作的数目等，aio的意思是异步I/O</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">ibuf aio reads: 0, log i/o&#39;s: 0, sync i/o&#39;s: 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#insert buffer thread挂起的fsync()操作数目等</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending flushes (fsync) log: 0; buffer pool: 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#log thread挂起的fsync()操作数目等</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">146246831 OS file reads, 760501349 OS file writes, 247143684 OS fsyncs&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了读，写和fsync()调用执行的数目，在你的机器环境负载下这些绝对值可能会有所不同，因此更重要的是监控它们过去一段时间内是如何改变的。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1 pending preads, 0 pending pwrites&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了当前被挂起的读和写操作数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">145.49 reads/s, 783677 avg bytes/read, 28.75 writes/s, 10.67 fsyncs/s&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了在头部显示的时间（指的是第1部分的时间）段内的每秒平均值。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">注：三行挂起读写线程、缓冲池线程、日志线程的统计信息的值是检测I/O受限的应用的一个好方法，如果这些I/O大部分有挂起操作，那么负载可能I/O受限。在linux系统下使用参数：innodb_read_io_threads和innodb_write_io_threads两个变量来配置读写线程的数量，默认为各4个线程。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">insert buffer thread：负责插入缓冲合并，如：记录被从插入缓冲合并到表空间中</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">log thread：负责异步刷事务日志</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">read thread：执行预读操作以尝试预先读取innodb预感需要的数据</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">write thread：刷新脏页缓冲</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">8.这部分显示了insert buffer和adaptive hash index两个部分的结构的状态</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">-------------------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">INSERT BUFFER AND ADAPTIVE HASH INDEX</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">-------------------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Ibuf: size 12, free list len 27559, seg size 27572, 18074934 merges&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了关于size（size 12代表了已经合并记录页的数量）、free list（代表了插入缓冲中空闲列表长度）和seg size大小（seg size 27572显示了当前insert buffer的长度，大小为27572*16K=440M左右）的信息。18074934 merges代表合并插入的次数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">merged operations:</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这个标签</strong><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">下的一行信息insert，delete mark，delete分别表示merge操作合并了多少个insert buffer，delete buffer，purge buffer</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">insert 81340470, delete mark 8893610, delete 818579</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">discarded operations:</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这个标签下的一行信息表示当change buffer发生merge时表已经被删除了，就不需要再将记录合并到辅助索引中了</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">insert 0, delete mark 0, delete 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Hash table size 87709057, node heap has 10228 buffer(s)</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了自使用哈希索引的状态，其中，Hash table size 87709057表示AHI的大小，node heap has 10228 buffer(s)表示AHI的使用情况</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1741.05 hash searches/s, 539.48 non-hash searches/s</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了在头部第1部分提及的时间内Innodb每秒完成了多少哈希索引操作，1741.05 hash searches/s表示每秒使用AHI搜索的情况，539.48 non-hash searches/s表示每秒没有使用AHI搜索的情况(因为哈希索引只能用于等值查询，而范围查询，模糊查询是不能使用哈希索引的。)，通过hash searches: non-hash searches的比例大概可以了解使用哈希索引后的效率，哈希索引查找与非哈希索引查找的比例仅供参考，自适应哈希索引无法配置，但是可以通过innodb_adaptive_hash_index=ON|OFF参数来选择是否需要这个特性。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">注：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">innodb从1.0.x开始引入change buffer，可以视为insert buffer的升级，从这个版本开始，innodb可以对DML操作(insert,delete,update)都进行缓冲，他们分别是insert buffer,delete buffer,purge buffer，当然和之前insert buffer一样，change buffer适用对象仍然是非唯一索引的辅助索引，因为没有update buffer，所以对一条记录进行update的操作可以分为两个过程：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">A：将记录标记为删除</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">B：真正将记录删除</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">因此，delete buffer对应update 操作的第一个过程，即将记录标记为删除，purge buffer对应update的第二个过程，即将记录真正地删除</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">9.这部分显示了关于innodb事务日志（重做日志）子系统的统计：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LOG</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Log sequence number 1351392990515&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了当前最新数据产生的日志序列号</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Log flushed up to 1351392989504&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了日志已经刷新到哪个位置了（已经落盘到事务日志中的日志序列号）</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Last checkpoint at 1351373900020&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了上一次检查点的位置（一个检查点表示一个数据和日志文件都处于一致状态的时刻，并且能用于恢复数据），如果上一次检查点落后与上一行太多，并且差异接近于事务日志文件的大小，Innodb会触发“疯狂刷”，这对性能而言非常糟糕。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0 pending log writes, 0 pending chkp writes</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了当前挂起的日志读写操作，可以将这行的值与第7部分FILE I/O对应的值做比较，以了解你的I/O有多少是由于日志系统引起的。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">286879989 log i/o&#39;s done, 15.92 log i/o&#39;s/second&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了日志操作的统计和每秒日志I/O数，可以将这行的值与第7部分FILE I/O对应的值做比较，以了解你的I/O有多少是由于日志系统引起的。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">9.这部分显示了关于innodb缓冲池及其如何使用内存的统计：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">9.1.</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">BUFFER POOL AND MEMORY</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Total memory allocated 45357793280; in additional pool allocated 0</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了由innodb分配的总内存，以及其中多少是额外内存池分配，额外内存池仅分配了其中很小一部分内存，由内部内存分配器分配，现在的innodb版本一般使用操作系统的内存分配器，但老版本使用自己的，这是由于在那个时代有些操作系统并未提供一个非常好的内存分配实现。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Dictionary memory allocated 12681573</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Buffer pool size 2705015&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#从这行开始的下面4行显示缓冲池度量值，以页为单位，度量值有总的缓冲池大小，空闲页数，分配用来存储数据库页的页数，以及脏数据库页数。这行显示了缓冲池总共有多少个页，即即2705015*16K，共有43G的缓冲池</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Free buffers 5&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了缓冲池空闲页数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Database pages 2694782&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了分配用来存储数据库页的页数，即，表示LRU列表中页的数量,包含young sublist和old sublist</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Old database pages 994651&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了LRU中的old sublist部分页的数量</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Modified db pages 10610</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示脏数据库页数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending reads 128&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了挂起读的数量</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending writes: LRU 0, flush list 0, single page 0</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了挂起写的数量</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#注意，这里挂起的读和写操作并不与FILE I/O部分的值匹配，因为Innodb可能合并许多的逻辑读写操作到一个物理I/O操作中，LRU代表最近使用到的被挂起数量，它是通过冲刷缓冲中不经常使用的页来释放空间以供给经常使用的页的一种方法，冲刷列表flush list存放着检查点处理需要冲刷的旧页被挂起的数量，单页single page被挂起的数量（single page写是独立的页面写，不会被合并)。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages made young 3014373561, not young 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了LRU列表中页移动到LRU首部的次数，因为该服务器在运行阶段改变没有达到innodb_old_blocks_time阀值的值，因此not young为0</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">6960.42 youngs/s, 0.00 non-youngs/s</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#表示每秒</strong><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">young和non-youngs这两类操作的次数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages read 2946570833, created 43450158, written 574214278</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了innodb被读取，创建，写入了多少页，读/写页的值是指的从磁盘读到缓冲池的数据，或者从缓冲池写到磁盘中的数据，创建页指的是innodb在缓冲池中分配但没有从数据文件中读取内容的页，因为它并不关心内容是什么（如，它们可能属于一个已经被删除的表）</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">6960.54 reads/s, 4.42 creates/s, 9.33 writes/s&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了对应上面一行的每秒read，create，write的页数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Buffer pool hit rate 955 / 1000, young-making rate 45 / 1000 not 0 / 1000&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了缓冲池的命中率，它用来衡量innodb在缓冲池中查找到所需页的比例，它度量自上次Innodb状态输出后到本次输出这段时间内的命中率，因此，如果服务器自那以后一直很安静，你将会看到No buffer pool page gets since the last printout。它对于度量缓存池的大小并没有用处。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages read ahead 6928.54/s, evicted without access 8.21/s, Random read ahead 0.00/s</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">&nbsp;#这行显示了页面预读，随机预读的每秒页数</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LRU len: 2694782, unzip_LRU len: 0&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#innodb1.0.x开始支持压缩页的功能，将原来16K的页压缩为1K，2K，4K，8K，而由于页的大小发生了变化，LRU列表也有了些改变，对于非16K的页，是通过unzip_LRU列表进行管理的，可以看到unzip_LRU len为0表示没有使用压缩页.</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O sum[60790]:cur[30], unzip sum[0]:cur[0]</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">对于压缩页的表，每个表的压缩比例可能不同，可能存在有的表页大小为8K，有的表页大小为2K的情况，unzip_LRUs 怎样从缓存池中分配内存的呢？</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">首先，在unzip_LRU列表中对不同压缩页大小的页进行分别管理，其次，通过伙伴算法进行内存的分配，例如：需要从缓存池中申请页为4K的大小，其过程如下：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">a：检查4K的unzip_LRU列表，检查是否有可用的空闲页</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">b：若有，则直接使用</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">c：若没有，检查8K的unzip_LRU列表</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">d：若能够得到空闲页，将页分成2个4K的页，存放到4K的unzip_LRU列表</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">e：若不能得到空闲页，从LRU列表中申请一个16K的页，将页分成1个8K，2个4K的页，分别存放到各自大小对应的unzip_LRU列表中。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">注：可能出现Free buffers和Database pages之和不等于Buffer pool size，因为缓冲池中的页肯会被分配给自适应哈希索引，lock信息，insert buffer等，而这部分页不需要LRU算法进行维护，因此不在LRU列表中。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">9.2.如果innodb buffer pool使用参数innodb</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">_buffer_pool_instances=num设置了大于1个缓冲池实例，那么就会按照这个参数把innodb_buffer_pool_size=xxx平分为num份。每份的信息显示类似如下，这部分的内容和9.1小节内容类似，就不再多说。</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">INDIVIDUAL BUFFER POOL INFO</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---BUFFER POOL 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Buffer pool size 541003</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Free buffers 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Database pages 538965</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Old database pages 198933</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Modified db pages 2190</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending reads 128</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending writes: LRU 0, flush list 0, single page 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages made young 603372180, not young 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1441.81 youngs/s, 0.00 non-youngs/s</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages read 589705199, created 8703138, written 116954697</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1441.61 reads/s, 0.75 creates/s, 1.83 writes/s</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Buffer pool hit rate 955 / 1000, young-making rate 45 / 1000 not 0 / 1000</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages read ahead 1436.98/s, evicted without access 0.87/s, Random read ahead 0.00/s</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LRU len: 538965, unzip_LRU len: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O sum[12158]:cur[6], unzip sum[0]:cur[0]</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">---BUFFER POOL 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Buffer pool size 541003</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Free buffers 1</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Database pages 538959</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Old database pages 198931</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Modified db pages 2025</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending reads 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pending writes: LRU 0, flush list 0, single page 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages made young 602366394, not young 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1481.35 youngs/s, 0.00 non-youngs/s</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages read 588738997, created 8708171, written 113209540</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">1480.56 reads/s, 0.83 creates/s, 1.92 writes/s</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Buffer pool hit rate 958 / 1000, young-making rate 42 / 1000 not 0 / 1000</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Pages read ahead 1473.73/s, evicted without access 1.96/s, Random read ahead 0.00/s</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">LRU len: 538959, unzip_LRU len: 0</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I/O sum[12158]:cur[6], unzip sum[0]:cur[0]</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">10.这部分显示了其他各项的innodb统计：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">ROW OPERATIONS</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">--------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">0 queries inside InnoDB, 0 queries in queue&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了innodb内核内有多少个线程，队列中有多少个线程，队列中的查询是innodb为限制并发执行的线程数量而不运行进入内核的线程。查询在进入队列之前会休眠等待。</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">5 read views open inside InnoDB&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了有多少打开的innodb读视图，读视图是包含事务开始点的数据库内容的MVCC快照，你可以看看某特定事务在第6部分TRANSACTIONS是否有读视图</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Main thread process no. 4368, id 140653691242240, state: sleeping&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了内核的主线程状态</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">Number of rows inserted 3429012215, updated 153529675, deleted 112310240, read 3739562987410&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了多少行被插入，更新和删除，读取</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">428.52 inserts/s, 7.21 updates/s, 0.46 deletes/s, 1047933.92 reads/s&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#这行显示了对应上面一行的每秒平均值，如果想查看innodb有多少工作量在进行，那么这两行是很好的参考值</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">----------------------------</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">END OF INNODB MONITOR OUTPUT&nbsp;</span><strong style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);">#要注意了，如果看不到这行输出，可能是有大量事务或者是有一个大的死锁截断了输出信息</strong><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">============================</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">注：内核的主线程状态可能的状态值有如下一些：</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">A：doing background drop tables</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">B：doing insert buffer merge</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">C：flushing buffer pool pages</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">D：making checkpoint</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">E：purging</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">F：reserving kernel mutex</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">G：sleeping</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">H：suspending</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">I：waiting for buffer pool flush to end</span><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><br style="margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"/><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">J：waiting for server activity</span></p>',
  'is_tui' => '1',
  'status' => '1',
  'views' => '1',
  'auth' => '韩会强',
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000308s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000831s ]
[ sql ] [ SQL ] INSERT INTO `think_article` (`title` , `cate_id` , `type` , `keyword` , `remark` , `content` , `is_tui` , `status` , `views` , `auth` , `photo` , `ip` , `update_time` , `create_time`) VALUES ('show engine innodb status解读' , 22 , 0 , 'mysql 解读 ' , 'innodb存储引擎在show engine innodb status（老版本对应的是show innodb status）输出中，显示除了大量的内部信息，它输出就是一个单独的字符串，没有行和列，内容分为很多小段，每一段对应innodb存储引擎不同部分的信息，其中有一些信息对于innodb开发者来说非常有用，但是，许多信息，如果你尝试去理解，并且应用到高性能innodb调优的时候，你会发现它们非常有趣，甚至是非常有必要的。' , '<p><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">注：以下内容为根据《高性能mysql第三版》和《mysql技术内幕innodb存储引擎》的innodb status部分的个人理解，如果有错误，还望指正！！</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">　　innodb存储引擎在show engine innodb status（老版本对应的是show innodb status）输出中，显示除了大量的内部信息，它输出就是一个单独的字符串，没有行和列，内容分为很多小段，每一段对应innodb存储引擎不同部分的信息，其中有一些信息对于innodb开发者来说非常有用，但是，许多信息，如果你尝试去理解，并且应用到高性能innodb调优的时候，你会发现它们非常有趣，甚至是非常有必要的。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">输出内容中包含了一些平均值的统计信息，这些平均值是自上次输出结果生成以来的统计数，因此，如果你正在检查这些值，那就要确保已经等待了至少30s的时间，使两次采样之间的积累足够长的统计时间并多次采样，检查计数器变化从而弄清其行为，并不是所有的输出都会在一个时间点上生成，因而也不是所有的显示出来的平均值会在同一时间间隔里重新再计算。而且，innodb有一个内部复位间隔，而它是不可预知的，各个版本也不一样。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">这些输出信息足够提供给手工计算出大多数你想要的统计信息，有一款监控工具innotop可以帮你计算出增量差值和平均值。下面，在你的mysql命令行敲下show engine innodb status;看着输出跟着下面的步骤一步一步理解输出信息是什么含义：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">注意：以下使用mysql5.5.24版本做解读，mysql5.6.x和5.7.x输出内容有些地方有调整。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1.第一段是头部信息，它仅仅声明了输出的开始，其内容包括当前的日期和时间，以及自上次输出以来经过的时长。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">=====================================</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">160129 12:07:26 INNODB MONITOR OUTPUT&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#第二行是当前日期和时间</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">=====================================</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Per second averages calculated from the last 24 seconds</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#第四行显示的是计算出这一平均值的时间间隔，即自上次输出以来的时间，或者是距上次内部复位的时长</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2.从innodb1.0.x开始，可以使用命令show engine innodb status;来查看master thread的状态信息:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">-----------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">BACKGROUND THREAD</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">-----------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">srv_master_thread loops: 30977173 1_second, 30975685 sleeps, 3090359 10_second, 166112 background, 165988 flush&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示主循环进行了30977173 1_second次，每秒挂起的操作进行了30975685 sleeps次（说明负载不是很大），10秒一次的活动进行了3090359 10_second次，1秒循环和10秒循环比值符合1：10，backgroup loop进行了166112 background次，flush loop进行了165988 flush次，如果在一台很大压力的mysql上，可能看到每秒运行次数和挂起次数比例小于1很多，这是因为innodb对内部进行了一些优化，当压力大时间隔时间并不总是等待1秒，因此，不能认为每秒循环和挂起的值总是相等，在某些情况下，可以通过两者之间的差值来比较反映当前数据库的负载压力。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">srv_master_thread log flush and writes: 31160103</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3.如果有高并发的工作负载，你就要关注下接下来的段（SEMAPHORES信号量）,它包含了两种数据：事件计数器以及可选的当前等待线程的列表，如果有性能上的瓶颈，可以使用这些信息来找出瓶颈，不幸的是，想知道怎么使用这些信息还是有一点复杂，下面先给出一些解释：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">SEMAPHORES</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">OS WAIT ARRAY INFO: reservation count 68581015, signal count 218437328&nbsp;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--Thread 140653057947392 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">S-lock on RW-latch at 0x7ff536c7d3c0 created in file buf0buf.c line 916</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">a writer (thread id 140653057947392) has reserved it in mode exclusive</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">number of readers 0, waiters flag 1, lock_word: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time read locked in file row0sel.c line 3097</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--Thread 140653677291264 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">S-lock on RW-latch at 0x7ff53945b240 created in file buf0buf.c line 916</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">a writer (thread id 140653677291264) has reserved it in mode exclusive</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">number of readers 0, waiters flag 1, lock_word: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time read locked in file row0sel.c line 3097</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Mutex spin waits 1157217380, rounds 1783981614, OS waits 10610359</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RW-shared spins 103830012, rounds 1982690277, OS waits 52051891</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RW-excl spins 43730722, rounds 602114981, OS waits 3495769</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Spin rounds per wait: 1.54 mutex, 19.10 RW-shared, 13.77 RW-excl</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">内容比较多，下面分段依次解释：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3.1.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">OS WAIT ARRAY INFO: reservation count 68581015, signal count 218437328&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行给出了关于操作系统等待数组的信息，它是一个插槽数组，innodb在数组里为信号量保留了一些插槽，操作系统用这些信号量给线程发送信号，使线程可以继续运行，以完成它们等着做的事情，这一行还显示出innodb使用了多少次操作系统的等待：保留统计（reservation count）显示了innodb分配插槽的频度，而信号</strong><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">计数（signal count）衡量的是线程通过数组得到信号的频度，操作系统的等待相对于空转等待（spin wait）要昂贵些。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3.2.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--Thread 140653057947392 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">S-lock on RW-latch at 0x7ff536c7d3c0 created in file buf0buf.c line 916</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">a writer (thread id 140653057947392) has reserved it in mode exclusive</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">number of readers 0, waiters flag 1, lock_word: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time read locked in file row0sel.c line 3097</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--Thread 140653677291264 has waited at btr0pcur.c line 437 for 0.00 seconds the semaphore:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">S-lock on RW-latch at 0x7ff53945b240 created in file buf0buf.c line 916</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">a writer (thread id 140653677291264) has reserved it in mode exclusive</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">number of readers 0, waiters flag 1, lock_word: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time read locked in file row0sel.c line 3097</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last time write locked in file /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">这部分显示的是当前正在等待互斥量的innodb线程，在这里可以看到有两个线程正在等待，每一个都是以--Thread &lt;数字&gt; has waited...开始，这一段内容在正常情况下应该是空的（即查看的时候没有这部分内容），除非服务器运行着高并发的工作负载，促使innodb采取让操作系统等待的措施，除非你对innodb源码熟悉，否则这里看到的最有用的信息就是发生线程等待的代码文件名 /usr/local/src/soft/mysql-5.5.24/storage/innobase/buf/buf0buf.c line 3151。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">在innodb内部哪里才是热点？举例来说，如果看到许多线程都在一个名为buf0buf.c的文件上等待，那就意味着你的系统里存在着</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">缓冲池竞争，这个输出信息还显示了这些线程等待了多少时间，其中waiters flag显示了有多少个等待着正在等待同一个互斥量。 如果waiters flag为0那就表示没有线程在等待同一个互斥量（此时在waiters flag 0后面可能可以看到wait is ending，表示这个互斥量已经被释放了，但操作系统还没有把线程调度过来运行）。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">你可能想知道innodb真正等待的是什么，innodb使用了互斥量和信号量来保护代码的临界区，如：限定每次只能有一个线程进入临界区，或者是当有活动的读时，就限制写入等。在innodb代码里有很多临界区，在合适的条件下，它们都可能出现在那里，常常能见到的一种情形是：获取缓冲池分页的访问权的时候。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3.3.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">在等待线程之后的部分信息如下，这部分显示了更多的事件计数器，在每一个情形中，都能看到innodb依靠操作系统等待的频度：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Mutex spin waits 1157217380, rounds 1783981614, OS waits 10610359</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示的是跟互斥量相关的几个计数器</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RW-shared spins 103830012, rounds 1982690277, OS waits 52051891&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示读写的共享锁的计数器</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RW-excl spins 43730722, rounds 602114981, OS waits 3495769&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示读写的排他锁的计数器</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Spin rounds per wait: 1.54 mutex, 19.10 RW-shared, 13.77 RW-excl</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">innodb有着一个多阶段等待的策略，首先，它会试着对锁进行空转等待，如果经历了一个预设的空转等待周期（设置innodb_sync_spin_loops配置变量命令）之后还没有成功，那就会退到更昂贵更复杂的等待数组中。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">空转等待的成本相对较低，但是它们要不停地检查一个资源能否被锁定，这种方式会消耗CPU周期，但是，这没有听起来那么糟糕，因为当处理器在等待IO时，一般都有一些空闲的CPU周期可用，即使是没有空闲的CPU周期，空等也要比其他方式更加廉价一些。然而，当另外一个线程能做一些事情的时候，空转等待也还会把CPU独占着。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">空转等待的替代方案就是让操作系统做上下文切换，这样，当一个线程在等待时，另外一个线程就可以被运行，然后，通过等待数组里的信号量发出信号，唤醒那个沉睡的线程，通过信号量来发送信号是比较有效的，但是上下文切换就很昂贵，这很快就会积少成多，每秒钟几千次的切换会引发大量的系统开销。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">你可以通过修改innodb_sync_spin_loops的值，试着在空转等待与操作系统等待之间达成平衡，不要担心空转等待，除非你在一秒里看到几十万个空转等待。此时，你可以考虑performance_schema库或者show engine innodb mutex;查看下相关信息。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4.下面这一段外键错误的信息一般不会出现，除非你服务器上发生了外键错误，有时问题在于事务在插入，更新或删除一条记录时要寻找父表或子表，还有时候是当innodb尝试增加或删除一个外键或者修改一个已经存在的外键时，发现表之间类型不匹配，这部分输出对于调试与innodb不明确的外键错误发生的准确原因非常有帮助，下面搞一个示例来看看：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4.1 创建父表：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; create table parent(parent_id int not null,primary key(parent_id)) engine=innodb;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4.2 创建子表：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; create table child(child_id int not null,key child_id(child_id),constraint i_child foreign key(child_id) references parent(parent_id)) engine=innodb;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4.3 插入数据：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; insert into parent(parent_id) values(1);</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; insert into child(child_id) values(1);</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4.5 有两种基本的外键错误：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">第一种：以某种可能违反外键约束关系的方法增加，更新，删除数据，将导致第一类错误，如，在父表中删除行时发生如下错误：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; delete from parent;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`xiaoboluo`.`child`, CONSTRAINT `i_child` FOREIGN KEY (`child_id`) REFERENCES `parent` (`parent_id`))</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">错误信息相当明了，对所有由增加，删除，更新不匹配的行导致的错误都会看到相似的信息，下面是show engine innodb status的输出：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LATEST FOREIGN KEY ERROR</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">160128 1:17:06 Transaction:&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了最近一次外键错误的日期和时间</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTION D203D6, ACTIVE 0 sec updating or deleting</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4 lock struct(s), heap size 1248, 2 row lock(s), undo log entries 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1813996 localhost root updating</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">delete from parent</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Foreign key constraint fails for table `xiaoboluo`.`child`:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">,</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#上面部分显示了关于破坏外键约束的事务详情。后边部分显示了发现错误时innodb正尝试修改的准确数据，输出中有许多是转换成可打印格式的行数据</strong><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">CONSTRAINT `i_child` FOREIGN KEY (`child_id`) REFERENCES `parent` (`parent_id`)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trying to delete or update in parent table, in index `PRIMARY` tuple:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">DATA TUPLE: 3 fields;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 80000001; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d203d6; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex 1e000001ca0110; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">But in child table `xiaoboluo`.`child`, in index `child_id`, there is a record:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">PHYSICAL RECORD: n_fields 2; compact format; info bits 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 80000001; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000013a99b3e; asc &gt;;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">4.6 第二种：尝试修改父表的表结构时发生的错误，这种错误就没有那么清楚了，这可能会让调试更困难：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; alter table parent modify parent_id int unsigned not null;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">ERROR 1025 (HY000): Error on rename of &#39;./xiaoboluo/#sql-b695_4e3b&#39; to &#39;./xiaoboluo/parent&#39; (errno: 150)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">查看show engine innodb status输出信息：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LATEST FOREIGN KEY ERROR</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">160128 1:32:33 Error in foreign key constraint of table xiaoboluo/child:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">there is no index in referenced table which would contain</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">the columns as the first columns, or the data types in the</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">referenced table do not match the ones in table. Constraint:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">,</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">CONSTRAINT &quot;i_child&quot; FOREIGN KEY (&quot;child_id&quot;) REFERENCES &quot;parent&quot; (&quot;parent_id&quot;)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">The index in the foreign key in table is &quot;child_id&quot;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">See&nbsp;</span><a href=\"http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html\" target=\"_blank\" style=\"margin: 0px; padding: 0px; color: black; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html</a><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">for correct foreign key definition.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">InnoDB: Renaming table `xiaoboluo`.&lt;result 2 when explaining filename &#39;#sql-b695_4e3b&#39;&gt; to `xiaoboluo`.`parent` failed!</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">上面的错误是数据类型不匹配，外键列必须有完全相同的数据类型，包括任何的修饰符（如这里父表多加了一个unsigned，这也是问题所在），当看到1025错误并不理解为什么时，最好查看下innodb status。在每次看到有新错误时，外键错误信息都会被重写，percona toolkit中的pt-fk-error-logger工具可以用表保存这些信息以供后续分析。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.与外键错误一样，这部分只有当服务器产生死锁时才会出现，死锁信息同样在每次有新的死锁错误时被重写，percona toolkit中的pt-deadlock-logger工具可以用表保存这些信息以供后续分析</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">死锁在等待关系图里是一个循环，就是一个锁定了行的数据结构又在等待别的锁，这个循环可以任意地大，innodb会立即检测到死锁，因为每当有事务等待行锁的时候，它都会去检查等待关系图里是否有循环，死锁的情况可能会比较复杂，但是，这一部分只显示了最近的两个死锁的情况，它们在各自的事务里执行的最后一条语句，以及它们在等待关系图里形成环锁的信息。在这个循环里你看不到其他事务，也可能看不到在事务里早先真正获得了锁的语句，尽管如此，通常还是可以通过查看这些输出结果来确定到底是什么引起了死锁。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">在innodb里实际上有两种死锁，第一种就是常常碰到的那种，它在等待关系图里是一个真正的循环，另外一种就是在一个等待关系图里，因代价昂贵而无法检测它是不是包含了循环，如果innodb要在关系图里检查超过100W个锁，或者在检查过程中，innodb要重做200个以上的事务，那它会放弃，并宣布这里有一个死锁，这些数值都是硬编码在innodb代码里的常量，无法配置（如果你NB可以修改代码然后重新编译）。第二种死锁报错你可以在输出里看到一条信息：TOO DEEP OR LONG SEARCH IN THE LOCK TABLE WAITS-FOR GRAPH</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">innodb不仅会打印出事务和事务持有和等待的锁，而且还有记录本身，不幸的是，它至于可能超过为输出结果预留的长度（只能打印1M的内容且只能保留最近一次的死锁信息），如果你无法看到完整的输出，此时可以在任意库下创建innodb_monitor或innodb_lock_monitor表，这样innodb status信息会完整且每15s一次被记录到错误日志中。如：create table innodb_monitor(a int)engine=innodb;，不需要记录到错误日志中时就删掉这个表即可。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1 下面也搞一个示例来看看：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1.1 建表：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; create table test_deadlock(id int unsigned not null primary key auto_increment,test int unsigned not null);</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Query OK, 0 rows affected (0.02 sec)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1.2 插入测试数据：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; insert into test_deadlock(test) values(1),(2),(3),(4),(5);</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Query OK, 5 rows affected (0.00 sec)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Records: 5 Duplicates: 0 Warnings: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">打开两个会话终端：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1.3 会话1执行下面的SQL：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; set autocommit=0;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Query OK, 0 rows affected (0.00 sec)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; select * from test_deadlock where id=1 for update;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">+----+------+</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">| id | test |</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">+----+------+</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">| 1 | 1 |</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">+----+------+</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1 row in set (0.00 sec)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1.4 接着会话2执行下面的SQL：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; set autocommit=0;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Query OK, 0 rows affected (0.00 sec)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; select * from test_deadlock where id=2 for update;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">+----+------+</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">| id | test |</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">+----+------+</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">| 2 | 2 |</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">+----+------+</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1 row in set (0.00 sec)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1.5 回到会话1执行下面的SQL，会发生等待：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; select * from test_deadlock where id=2 for update;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.1.6 回到会话2执行下面的SQL，产生死锁，会话2被回滚：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql&gt; select * from test_deadlock where id=1 for update;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.2 查看innodb status信息：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LATEST DETECTED DEADLOCK</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">160128 1:51:53&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这里显示了最近一次发生死锁的日期和时间</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (1) TRANSACTION:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTION D20847, ACTIVE 141 sec starting index read</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LOCK WAIT 3 lock struct(s), heap size 376, 2 row lock(s)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1818124 localhost root statistics</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">select * from test_deadlock where id=2 for update</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20847 lock_mode X locks rec but not gap waiting</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab011d; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (2) TRANSACTION:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTION D20853, ACTIVE 119 sec starting index read</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3 lock struct(s), heap size 1248, 2 row lock(s)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 20081, OS thread handle 0x7f0a0f020700, query id 1818204 localhost root statistics</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">select * from test_deadlock where id=1 for update</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (2) HOLDS THE LOCK(S):</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab011d; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap waiting</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 2 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000001; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab0110; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000001; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** WE ROLL BACK TRANSACTION (2)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">这部分内容比较多，下面分段逐一进行解释：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.2.1 下面这部分显示的是死锁的第一个事务的信息：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (1) TRANSACTION:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTION D20847, ACTIVE 141 sec starting index read</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LOCK WAIT 3 lock struct(s), heap size 376, 2 row lock(s)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1818124 localhost root statistics</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">select * from test_deadlock where id=2 for update</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTION D20847, ACTIVE 141 sec starting index read：</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">这行表示事务D20847，ACTIVE 141 sec表示事务处于活跃状态141s，starting index read表示正在使用索引读取数据行</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 1</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行表示事务D20847正在使用1个表，且涉及锁的表有1个</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LOCK WAIT 3 lock struct(s), heap size 376, 2 row lock(s)</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行表示在等待3把锁，占用内存376字节，涉及2行记录，如果事务已经锁定了几行数据，这里将会有一行信息显示出锁定结构的数目（注意，这跟行锁是两回事）和堆大小，堆的大小指的是为了持有这些行锁而占用的内存大小，Innodb是用一种特殊的位图表来实现行锁的，从理论上讲，它可将每一个锁定的行表示为一个比特，经测试显示，每个锁通常不超过4比特</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 20027, OS thread handle 0x7f0a4c0f8700, query id 1818124 localhost root statistics</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行表示该事务的线程ID信息，操作系统句柄信息，连接来源、用户</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">select * from test_deadlock where id=2 for update&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行表示事务涉及的SQL</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.2.2 下面这一部分显示的是当死锁发生时，第一个事务正在等待的锁等信息：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行信息表示第一个事务正在等待锁被授予</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20847 lock_mode X locks rec but not gap waiting</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab011d; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20847 lock_mode X locks rec but not gap waiting</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行信息表示等待的锁是一个record lock，空间id是441，页编号为3，大概位置在页的72位处，锁发生在表xiaoboluo.test_deadlock的主键上，是一个X锁，但是不是gap lock。 waiting表示正在等待锁</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行表示record lock的heap no 位置</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这部分剩下的内容只对调试才有用。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab011d; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.2.3 下面这部分是事务二的状态：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (2) TRANSACTION:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTION D20853, ACTIVE 119 sec starting index read&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#事务2处于活跃状态119s</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 1&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#正在使用1个表，涉及锁的表有1个</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3 lock struct(s), heap size 1248, 2 row lock(s)&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#涉及3把锁，2行记录</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 20081, OS thread handle 0x7f0a0f020700, query id 1818204 localhost root statistics</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">select * from test_deadlock where id=1 for update</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#第二个事务的SQL</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.2.4 下面这部分是事务二的持有锁信息：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (2) HOLDS THE LOCK(S):</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab011d; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000002; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 3 PHYSICAL RECORD: n_fields 4; compact format; info bits 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#从这两行持有锁信息计息后面几行调试信息上看，就是事务1正在等待的锁。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5.2.5 下面这部分是事务二正在等待的锁，从下面的信息上看，等待的是同一个表，同一个索引，同一个page上的record lock X锁，但是heap no位置不同，即不同的行上的锁：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">RECORD LOCKS space id 441 page no 3 n bits 72 index `PRIMARY` of table `xiaoboluo`.`test_deadlock` trx id D20853 lock_mode X locks rec but not gap waiting</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Record lock, heap no 2 PHYSICAL RECORD: n_fields 4; compact format; info bits 0&nbsp;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0: len 4; hex 00000001; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1: len 6; hex 000000d20808; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2: len 7; hex ad000001ab0110; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">3: len 4; hex 00000001; asc ;;</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">*** WE ROLL BACK TRANSACTION (2) #这个表示事务2被回滚，因为两个事务的回滚开销一样，所以选择了后提交的事务进行回滚，如果两个事务回滚的开销不同(undo 数量不同)，那么就回滚开销最小的那个事务。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">当一个事务持有了其他事务需要的锁，同时又想获得其他事务持有的锁时，等待关系图上就会产生循环，Innodb不会显示所有持有和等待的锁，但是，它显示了足够的信息来帮你确定，查询操作正在使用哪些索引，这对于你确定能否避免死锁有极大的价值。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">如果能使两个查询对同一个索引朝同一个方向进行扫描，就能降低死锁的数目，因为，查询在同一个顺序上请求锁的时候不会创建循环，有时候，这是很容易做到的，如：要在一个事务里更新许多条记录，就可以在应用程序的内存里把它们按照主键进行排序，然后，再用同样的顺序更新到数据库里，这样就不会有死锁发生，但是在另一些时候，这个方法也是行不通的（如果有两个进程使用了不同的索引区间操作同一张表的时候）。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">6. 下面这部分包含了一些关于innodb事务的总结信息，紧随其后的是当前活跃事务列表，如：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">TRANSACTIONS</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trx id counter 4E0132AD</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Purge done for trx&#39;s n:o &lt; 4E01090B undo n:o &lt; 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">History list length 1853</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LIST OF TRANSACTIONS FOR EACH SESSION:</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0131D3, not started</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208218, OS thread handle 0x7fec7c582700, query id 5274800318 10.207.162.69 gdsser</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E01323F, not started</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208217, OS thread handle 0x7fec7c1b3700, query id 5274800938 10.207.162.69 gdsser</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">....................</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0132AC, ACTIVE 0 sec preparing</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">2 lock struct(s), heap size 376, 1 row lock(s), undo log entries 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208200, OS thread handle 0x7fec567e0700, query id 5274801557 10.207.162.69 gdsser</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">commit</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0110E7, ACTIVE 188 sec</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208154, OS thread handle 0x7fec7c235700, query id 5274800671 10.143.90.228 root Sending data</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowskillpoint`</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trx read view will not see trx with id &gt;= 4E0110E8, sees &lt; 4E0108EE</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0108EF, ACTIVE 233 sec fetching rows</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208131, OS thread handle 0x7fec578e3700, query id 5274801341 10.143.90.228 root Sending data</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowsilver`</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trx read view will not see trx with id &gt;= 4E0108F0, sees &lt; 4E0108EC</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0108EE, ACTIVE 233 sec fetching rows</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208132, OS thread handle 0x7fec7c78a700, query id 5274797797 10.143.90.228 root Sending data</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowmail`</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trx read view will not see trx with id &gt;= 4E0108EF, sees &lt; 4E0108EC</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">这部分内容比较多，下面分段逐一进行解释：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">6.1.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trx id counter 4E0132AD&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行表示当前事务ID，这是一个系统变量，每创建一个新事务都会增加</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Purge done for trx&#39;s n:o &lt; 4E01090B undo n:o &lt; 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这是innodb清除旧MVCC行时所用的事务ID，将这个值和当前事务ID进行比较，就可以知道有多少老版本的数据未被清除。这个数字多大才可以安全的取值没有硬性和速成的规定，如果数据没做过任何更新，那么一个巨大的数字也不意味着有未清除的数据，因为实际上所有事务在数据库里查看的都是同一个版本的数据（此时只是事务ID在增加，而数据没有变更），另一方面，如果有很多行被更新，那每一行就会有一个或多个版本留在内存里，减少此类开销的最好办法就是确保事务已完成就立即提交，不要让它长时间地处于打开状态，因为一个打开的事务即使不做任何操作，也会影响到innodb清理旧版本的行数据。 undo n:o &lt; 0这个是innodb清理进程正在使用的撤销日志编号，为0 0时说明清理进程处于空闲状态。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">History list length 1853&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#历史记录的长度，即位于innodb数据文件的撤销空间里的页面的数目，如果事务执行了更新并提交，这个数字就会增加，而当清理进程移除旧版本数据时，它就会减少，清理进程也会更新Purge done for.....这行中的数值。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">6.2.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">头部信息之后就是一个事务列表，当前版本的mysql还不支持嵌套事务，因此，在某个时间点上，每个客户端连接能够拥有的事务数量是有一个上限的，而且每一个事务只能属于单一连接（即一个事务只能使用单个线程执行，不能使用多个线程）。在输出信息里，每一个事务至少占有两行内容，如：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0131D3, not started</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#每个事务的第一行以事务的ID和状态开始，not started表示这个事务已经提交并且没有再发起影响事务的语句，可能刚好空闲</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208218, OS thread handle 0x7fec7c582700, query id 5274800318 10.207.162.69 gdsser</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#然后每个事务的第二行是一些线程等信息，MySQL thread id &lt;数字&gt;部分和是hi用show full processlist;命令看到的id列相同。紧随其后的是一个内部查询id和一些连接信息，这些信息同样与show full processlist中的输出相同。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E01323F, not started</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208217, OS thread handle 0x7fec7c1b3700, query id 5274800938 10.207.162.69 gdsser</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">6.3.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">上面是not started状态的事务信息，下面来看看为ACTIVE状态的事务信息：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---TRANSACTION 4E0110E7, ACTIVE 188 sec&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示次事务处于活跃状态已经188s，可能的所有状态有not started，active，prepared和committed in memory，一旦事务日志落盘了就会变成not started状态。在时间后面会显示出当前事务正在做什么（在这里为空没有显示出来），在源代码中有超过30个字符串常量可以显示在时间后面，如：fetching，preparing，rows，adding foreign keys等等</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">mysql tables in use 1, locked 0</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#该事务用到的表数和涉及表锁的表数，Innodb一般不会锁定表，但对有些语句会锁定，如果mysql服务器在高于innodb层之上将表锁定，这里也是能够显示出来的，如果事务已经锁定了几行数据，这里将会有一行信息显示出锁定结构的数目（注意，这跟行锁是两回事）和和堆大小，如：2 lock struct(s), heap size 376, 1 row lock(s), undo log entries 1，堆的大小指的是为了持有这些行锁而占用的内存大小，Innodb是用一种特殊的位图表来实现行锁的，从理论上讲，它可将每一个锁定的行表示为一个比特，经测试显示，每个锁通常不超过4比特。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">MySQL thread id 26208154, OS thread handle 0x7fec7c235700, query id 5274800671 10.143.90.228 root Sending data</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#与show processlist输出结果大部分相同</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">SELECT /*!40001 SQL_NO_CACHE */ * FROM `m_flowskillpoint`&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#如果事务正在运行一个查询，那么这里就会显示事务涉及的SQL，注意：有些版本可能只显示其中一小段，而不是完整的SQL</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Trx read view will not see trx with id &gt;= 4E0110E8, sees &lt; 4E0108EE&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了事务的读视图，它表明了因为版本关系而产生的对于事务可见和不可见两种类型的事务ID的范围，在这里，两个数字之间有一个事务的间隙，这个间隙里的事务可能是不可见的，innodb在执行查询时，对于那些事务ID正好在这个间隙的行，还会检查其可见性。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">注：如果事务正在等待一个锁，那么在查询SQL文本后面将可以看到这个锁的信息，在上文的死锁例子里，这样的信息看到过很多了，不幸的是，输出信息并没有说出这个锁正被其他哪个事务持有，不过可以通过information_schema库下的innodb_trx，innodb_lock_waits，innodb_locks三个表来查明这一点。如果输出信息里有很多个事务，innodb可能会限制要打印出来的事务数目，以免输出信息增长得太大，这时就会看到...truncated...提示。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">7.FILE I/O部分显示的是I/O辅助线程的状态，还有性能计数器的状态，如下：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">FILE I/O</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 0 state: waiting for i/o request (insert buffer thread)&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#insert buffer thread</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 1 state: waiting for i/o request (log thread)&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#log thread</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 2 state: waiting for i/o request (read thread)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 3 state: waiting for i/o request (read thread)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 4 state: waiting for i/o request (read thread)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 5 state: doing file i/o (read thread) ev set&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#以上为默认的4个read thread</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 6 state: waiting for i/o request (write thread)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 7 state: waiting for i/o request (write thread)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 8 state: waiting for i/o request (write thread)</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O thread 9 state: waiting for i/o request (write thread)</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#以上为默认的4个write thread</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending normal aio reads: 128 [0, 0, 0, 128] , aio writes: 0 [0, 0, 0, 0] ,&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#读线程和写线程挂起操作的数目等，aio的意思是异步I/O</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">ibuf aio reads: 0, log i/o&#39;s: 0, sync i/o&#39;s: 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#insert buffer thread挂起的fsync()操作数目等</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending flushes (fsync) log: 0; buffer pool: 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#log thread挂起的fsync()操作数目等</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">146246831 OS file reads, 760501349 OS file writes, 247143684 OS fsyncs&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了读，写和fsync()调用执行的数目，在你的机器环境负载下这些绝对值可能会有所不同，因此更重要的是监控它们过去一段时间内是如何改变的。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1 pending preads, 0 pending pwrites&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了当前被挂起的读和写操作数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">145.49 reads/s, 783677 avg bytes/read, 28.75 writes/s, 10.67 fsyncs/s&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了在头部显示的时间（指的是第1部分的时间）段内的每秒平均值。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">注：三行挂起读写线程、缓冲池线程、日志线程的统计信息的值是检测I/O受限的应用的一个好方法，如果这些I/O大部分有挂起操作，那么负载可能I/O受限。在linux系统下使用参数：innodb_read_io_threads和innodb_write_io_threads两个变量来配置读写线程的数量，默认为各4个线程。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">insert buffer thread：负责插入缓冲合并，如：记录被从插入缓冲合并到表空间中</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">log thread：负责异步刷事务日志</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">read thread：执行预读操作以尝试预先读取innodb预感需要的数据</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">write thread：刷新脏页缓冲</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">8.这部分显示了insert buffer和adaptive hash index两个部分的结构的状态</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">-------------------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">INSERT BUFFER AND ADAPTIVE HASH INDEX</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">-------------------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Ibuf: size 12, free list len 27559, seg size 27572, 18074934 merges&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了关于size（size 12代表了已经合并记录页的数量）、free list（代表了插入缓冲中空闲列表长度）和seg size大小（seg size 27572显示了当前insert buffer的长度，大小为27572*16K=440M左右）的信息。18074934 merges代表合并插入的次数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">merged operations:</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这个标签</strong><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">下的一行信息insert，delete mark，delete分别表示merge操作合并了多少个insert buffer，delete buffer，purge buffer</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">insert 81340470, delete mark 8893610, delete 818579</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">discarded operations:</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这个标签下的一行信息表示当change buffer发生merge时表已经被删除了，就不需要再将记录合并到辅助索引中了</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">insert 0, delete mark 0, delete 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Hash table size 87709057, node heap has 10228 buffer(s)</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了自使用哈希索引的状态，其中，Hash table size 87709057表示AHI的大小，node heap has 10228 buffer(s)表示AHI的使用情况</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1741.05 hash searches/s, 539.48 non-hash searches/s</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了在头部第1部分提及的时间内Innodb每秒完成了多少哈希索引操作，1741.05 hash searches/s表示每秒使用AHI搜索的情况，539.48 non-hash searches/s表示每秒没有使用AHI搜索的情况(因为哈希索引只能用于等值查询，而范围查询，模糊查询是不能使用哈希索引的。)，通过hash searches: non-hash searches的比例大概可以了解使用哈希索引后的效率，哈希索引查找与非哈希索引查找的比例仅供参考，自适应哈希索引无法配置，但是可以通过innodb_adaptive_hash_index=ON|OFF参数来选择是否需要这个特性。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">注：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">innodb从1.0.x开始引入change buffer，可以视为insert buffer的升级，从这个版本开始，innodb可以对DML操作(insert,delete,update)都进行缓冲，他们分别是insert buffer,delete buffer,purge buffer，当然和之前insert buffer一样，change buffer适用对象仍然是非唯一索引的辅助索引，因为没有update buffer，所以对一条记录进行update的操作可以分为两个过程：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">A：将记录标记为删除</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">B：真正将记录删除</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">因此，delete buffer对应update 操作的第一个过程，即将记录标记为删除，purge buffer对应update的第二个过程，即将记录真正地删除</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">9.这部分显示了关于innodb事务日志（重做日志）子系统的统计：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LOG</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Log sequence number 1351392990515&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了当前最新数据产生的日志序列号</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Log flushed up to 1351392989504&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了日志已经刷新到哪个位置了（已经落盘到事务日志中的日志序列号）</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Last checkpoint at 1351373900020&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了上一次检查点的位置（一个检查点表示一个数据和日志文件都处于一致状态的时刻，并且能用于恢复数据），如果上一次检查点落后与上一行太多，并且差异接近于事务日志文件的大小，Innodb会触发“疯狂刷”，这对性能而言非常糟糕。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0 pending log writes, 0 pending chkp writes</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了当前挂起的日志读写操作，可以将这行的值与第7部分FILE I/O对应的值做比较，以了解你的I/O有多少是由于日志系统引起的。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">286879989 log i/o&#39;s done, 15.92 log i/o&#39;s/second&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了日志操作的统计和每秒日志I/O数，可以将这行的值与第7部分FILE I/O对应的值做比较，以了解你的I/O有多少是由于日志系统引起的。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">9.这部分显示了关于innodb缓冲池及其如何使用内存的统计：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">9.1.</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">BUFFER POOL AND MEMORY</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Total memory allocated 45357793280; in additional pool allocated 0</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了由innodb分配的总内存，以及其中多少是额外内存池分配，额外内存池仅分配了其中很小一部分内存，由内部内存分配器分配，现在的innodb版本一般使用操作系统的内存分配器，但老版本使用自己的，这是由于在那个时代有些操作系统并未提供一个非常好的内存分配实现。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Dictionary memory allocated 12681573</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Buffer pool size 2705015&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#从这行开始的下面4行显示缓冲池度量值，以页为单位，度量值有总的缓冲池大小，空闲页数，分配用来存储数据库页的页数，以及脏数据库页数。这行显示了缓冲池总共有多少个页，即即2705015*16K，共有43G的缓冲池</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Free buffers 5&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了缓冲池空闲页数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Database pages 2694782&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了分配用来存储数据库页的页数，即，表示LRU列表中页的数量,包含young sublist和old sublist</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Old database pages 994651&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了LRU中的old sublist部分页的数量</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Modified db pages 10610</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示脏数据库页数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending reads 128&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了挂起读的数量</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending writes: LRU 0, flush list 0, single page 0</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了挂起写的数量</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#注意，这里挂起的读和写操作并不与FILE I/O部分的值匹配，因为Innodb可能合并许多的逻辑读写操作到一个物理I/O操作中，LRU代表最近使用到的被挂起数量，它是通过冲刷缓冲中不经常使用的页来释放空间以供给经常使用的页的一种方法，冲刷列表flush list存放着检查点处理需要冲刷的旧页被挂起的数量，单页single page被挂起的数量（single page写是独立的页面写，不会被合并)。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages made young 3014373561, not young 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了LRU列表中页移动到LRU首部的次数，因为该服务器在运行阶段改变没有达到innodb_old_blocks_time阀值的值，因此not young为0</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">6960.42 youngs/s, 0.00 non-youngs/s</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#表示每秒</strong><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">young和non-youngs这两类操作的次数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages read 2946570833, created 43450158, written 574214278</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了innodb被读取，创建，写入了多少页，读/写页的值是指的从磁盘读到缓冲池的数据，或者从缓冲池写到磁盘中的数据，创建页指的是innodb在缓冲池中分配但没有从数据文件中读取内容的页，因为它并不关心内容是什么（如，它们可能属于一个已经被删除的表）</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">6960.54 reads/s, 4.42 creates/s, 9.33 writes/s&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了对应上面一行的每秒read，create，write的页数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Buffer pool hit rate 955 / 1000, young-making rate 45 / 1000 not 0 / 1000&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了缓冲池的命中率，它用来衡量innodb在缓冲池中查找到所需页的比例，它度量自上次Innodb状态输出后到本次输出这段时间内的命中率，因此，如果服务器自那以后一直很安静，你将会看到No buffer pool page gets since the last printout。它对于度量缓存池的大小并没有用处。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages read ahead 6928.54/s, evicted without access 8.21/s, Random read ahead 0.00/s</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;#这行显示了页面预读，随机预读的每秒页数</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LRU len: 2694782, unzip_LRU len: 0&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#innodb1.0.x开始支持压缩页的功能，将原来16K的页压缩为1K，2K，4K，8K，而由于页的大小发生了变化，LRU列表也有了些改变，对于非16K的页，是通过unzip_LRU列表进行管理的，可以看到unzip_LRU len为0表示没有使用压缩页.</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O sum[60790]:cur[30], unzip sum[0]:cur[0]</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">对于压缩页的表，每个表的压缩比例可能不同，可能存在有的表页大小为8K，有的表页大小为2K的情况，unzip_LRUs 怎样从缓存池中分配内存的呢？</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">首先，在unzip_LRU列表中对不同压缩页大小的页进行分别管理，其次，通过伙伴算法进行内存的分配，例如：需要从缓存池中申请页为4K的大小，其过程如下：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">a：检查4K的unzip_LRU列表，检查是否有可用的空闲页</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">b：若有，则直接使用</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">c：若没有，检查8K的unzip_LRU列表</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">d：若能够得到空闲页，将页分成2个4K的页，存放到4K的unzip_LRU列表</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">e：若不能得到空闲页，从LRU列表中申请一个16K的页，将页分成1个8K，2个4K的页，分别存放到各自大小对应的unzip_LRU列表中。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">注：可能出现Free buffers和Database pages之和不等于Buffer pool size，因为缓冲池中的页肯会被分配给自适应哈希索引，lock信息，insert buffer等，而这部分页不需要LRU算法进行维护，因此不在LRU列表中。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">9.2.如果innodb buffer pool使用参数innodb</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">_buffer_pool_instances=num设置了大于1个缓冲池实例，那么就会按照这个参数把innodb_buffer_pool_size=xxx平分为num份。每份的信息显示类似如下，这部分的内容和9.1小节内容类似，就不再多说。</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">INDIVIDUAL BUFFER POOL INFO</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---BUFFER POOL 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Buffer pool size 541003</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Free buffers 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Database pages 538965</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Old database pages 198933</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Modified db pages 2190</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending reads 128</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending writes: LRU 0, flush list 0, single page 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages made young 603372180, not young 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1441.81 youngs/s, 0.00 non-youngs/s</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages read 589705199, created 8703138, written 116954697</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1441.61 reads/s, 0.75 creates/s, 1.83 writes/s</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Buffer pool hit rate 955 / 1000, young-making rate 45 / 1000 not 0 / 1000</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages read ahead 1436.98/s, evicted without access 0.87/s, Random read ahead 0.00/s</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LRU len: 538965, unzip_LRU len: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O sum[12158]:cur[6], unzip sum[0]:cur[0]</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">---BUFFER POOL 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Buffer pool size 541003</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Free buffers 1</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Database pages 538959</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Old database pages 198931</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Modified db pages 2025</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending reads 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pending writes: LRU 0, flush list 0, single page 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages made young 602366394, not young 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1481.35 youngs/s, 0.00 non-youngs/s</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages read 588738997, created 8708171, written 113209540</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">1480.56 reads/s, 0.83 creates/s, 1.92 writes/s</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Buffer pool hit rate 958 / 1000, young-making rate 42 / 1000 not 0 / 1000</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Pages read ahead 1473.73/s, evicted without access 1.96/s, Random read ahead 0.00/s</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">LRU len: 538959, unzip_LRU len: 0</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I/O sum[12158]:cur[6], unzip sum[0]:cur[0]</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">10.这部分显示了其他各项的innodb统计：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">ROW OPERATIONS</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">--------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">0 queries inside InnoDB, 0 queries in queue&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了innodb内核内有多少个线程，队列中有多少个线程，队列中的查询是innodb为限制并发执行的线程数量而不运行进入内核的线程。查询在进入队列之前会休眠等待。</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">5 read views open inside InnoDB&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了有多少打开的innodb读视图，读视图是包含事务开始点的数据库内容的MVCC快照，你可以看看某特定事务在第6部分TRANSACTIONS是否有读视图</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Main thread process no. 4368, id 140653691242240, state: sleeping&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了内核的主线程状态</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">Number of rows inserted 3429012215, updated 153529675, deleted 112310240, read 3739562987410&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了多少行被插入，更新和删除，读取</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">428.52 inserts/s, 7.21 updates/s, 0.46 deletes/s, 1047933.92 reads/s&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#这行显示了对应上面一行的每秒平均值，如果想查看innodb有多少工作量在进行，那么这两行是很好的参考值</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">----------------------------</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">END OF INNODB MONITOR OUTPUT&nbsp;</span><strong style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\">#要注意了，如果看不到这行输出，可能是有大量事务或者是有一个大的死锁截断了输出信息</strong><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">============================</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">注：内核的主线程状态可能的状态值有如下一些：</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">A：doing background drop tables</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">B：doing insert buffer merge</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">C：flushing buffer pool pages</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">D：making checkpoint</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">E：purging</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">F：reserving kernel mutex</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">G：sleeping</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">H：suspending</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">I：waiting for buffer pool flush to end</span><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><br style=\"margin: 0px; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);\">J：waiting for server activity</span></p>' , 1 , 1 , 1 , '韩会强' , 'images/j5un3u5k_11soz52qcaoh5981731121c1d.jpg' , '123.233.116.122' , 1501655825 , 1501655825) [ RunTime:0.008856s ]

---------------------------------------------------------------
[ 2017-08-02T14:37:07+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] hhqblog.com/admin/article/index.html [运行时间：0.026887s][吞吐率：37.19req/s] [内存消耗：3,800.09kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000322s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000843s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000170s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.001010s ]

---------------------------------------------------------------
[ 2017-08-02T14:37:07+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.048852s][吞吐率：20.47req/s] [内存消耗：3,731.30kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000299s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000841s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000157s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000924s ]

---------------------------------------------------------------
[ 2017-08-02T14:37:20+08:00 ] 172.17.180.47 123.233.116.122 GET /
[ log ] hhqblog.com/ [运行时间：0.032137s][吞吐率：31.12req/s] [内存消耗：5,146.25kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000300s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000831s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000565s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000375s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000272s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000720s ]

---------------------------------------------------------------
[ 2017-08-02T14:37:20+08:00 ] 172.17.180.47 123.233.116.122 GET /index/index/index.html?page=1
[ log ] hhqblog.com/index/index/index.html?page=1 [运行时间：0.049682s][吞吐率：20.13req/s] [内存消耗：5,121.63kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_id.1.3fef=5dce351e789a92be.1500950707.2.1501654982.1501654981.; _pk_ses.1.3fef=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000306s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000828s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000578s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000385s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000266s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000744s ]

---------------------------------------------------------------
[ 2017-08-02T14:37:30+08:00 ] 172.17.180.47 123.233.116.122 GET /ar/38
[ log ] www.hhqblog.com/ar/38 [运行时间：0.037946s][吞吐率：26.35req/s] [内存消耗：4,524.84kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1500952384%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.1.1500952384.1500952384.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '38',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000350s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.001049s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000668s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 38 LIMIT 1 [ RunTime:0.000588s ]

---------------------------------------------------------------
[ 2017-08-02T14:38:07+08:00 ] 172.17.180.47 123.233.116.122 GET /admin
[ log ] www.hhqblog.com/admin [运行时间：0.015500s][吞吐率：64.52req/s] [内存消耗：1,978.17kb] [文件加载：44]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Index->index[ /yjdata/www/hhqblog/application/admin/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/public/index.html [ array (
) ]
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:38:07+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/index/main.html
[ log ] www.hhqblog.com/admin/index/main.html [运行时间：0.014777s][吞吐率：67.67req/s] [内存消耗：1,900.95kb] [文件加载：43]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'index',
    2 => 'main',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Index->main[ /yjdata/www/hhqblog/application/admin/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/index/index.html [ array (
  0 => 'info',
) ]
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:45:31+08:00 ] 172.17.180.47 157.55.39.100 GET /index/index/index.html?page=1
[ log ] hhqblog.com/index/index/index.html?page=1 [运行时间：0.066691s][吞吐率：14.99req/s] [内存消耗：5,110.12kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'cache-control' => 'no-cache',
  'connection' => 'Keep-Alive',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, deflate',
  'host' => 'hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000318s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000852s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000589s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000377s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000340s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000349s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000755s ]

---------------------------------------------------------------
[ 2017-08-02T14:50:35+08:00 ] 172.17.180.47 140.205.201.35 GET /
[ log ] www.hhqblog.com/ [运行时间：0.031502s][吞吐率：31.74req/s] [内存消耗：5,145.96kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'host' => 'www.hhqblog.com',
  'referer' => 'http://www.hhqblog.com/',
  'accept' => '*/*',
  'connection' => 'keep-alive',
  'accept-encoding' => 'gzip,deflate',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000308s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000817s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000571s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000380s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000278s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000781s ]

---------------------------------------------------------------
[ 2017-08-02T14:50:40+08:00 ] 172.17.180.47 140.205.201.35 GET /editors/index.html
[ log ] www.hhqblog.com/editors/index.html [运行时间：0.013012s][吞吐率：76.85req/s] [内存消耗：1,586.70kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'editors',
    1 => 'index',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:51:15+08:00 ] 172.17.180.47 140.205.201.35 GET /LICENSE.txt
[ log ] www.hhqblog.com/LICENSE.txt [运行时间：0.012857s][吞吐率：77.78req/s] [内存消耗：1,586.75kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'LICENSE.txt',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T14:51:17+08:00 ] 172.17.180.47 140.205.201.35 GET /extensions/kindeditor/themes/default/default.png)
[ log ] www.hhqblog.com/extensions/kindeditor/themes/default/default.png) [运行时间：0.013631s][吞吐率：73.36req/s] [内存消耗：1,587.30kb] [文件加载：37]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'extensions',
    1 => 'kindeditor',
    2 => 'themes',
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;Alibaba.Security.Heimdall.950384.p)',
  'cache-control' => 'no-cache',
  'pragma' => 'no-cache',
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'default' => 'default.png)',
)
[ info ] [ LOG ] INIT File

---------------------------------------------------------------
[ 2017-08-02T15:15:43+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] www.hhqblog.com/admin/article/index.html [运行时间：0.026406s][吞吐率：37.87req/s] [内存消耗：3,800.06kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000278s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000823s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000154s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000906s ]

---------------------------------------------------------------
[ 2017-08-02T15:15:44+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] www.hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.030912s][吞吐率：32.35req/s] [内存消耗：3,731.21kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000285s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000785s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000150s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000879s ]

---------------------------------------------------------------
[ 2017-08-02T15:15:47+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/add_article.html
[ log ] www.hhqblog.com/admin/article/add_article.html [运行时间：0.022841s][吞吐率：43.78req/s] [内存消耗：2,987.20kb] [文件加载：51]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/add_article.html [ array (
  0 => 'cates',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000294s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article_cate` [ RunTime:0.000765s ]
[ sql ] [ SQL ] SELECT `id`,`name` FROM `think_article_cate` [ RunTime:0.000200s ]

---------------------------------------------------------------
[ 2017-08-02T15:17:13+08:00 ] 172.17.180.47 123.233.116.122 POST /admin/article/add_article.html
[ log ] www.hhqblog.com/admin/article/add_article.html [运行时间：0.123703s][吞吐率：8.08req/s] [内存消耗：3,782.86kb] [文件加载：61]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'content-length' => '143496',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://www.hhqblog.com',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'content-type' => 'multipart/form-data; boundary=----WebKitFormBoundary6mBBJqz2veH62lJ6',
  'referer' => 'http://www.hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
)
[ info ] [ PARAM ] array (
  'title' => 'mysql导入数据load data infile用法',
  'cate_id' => '22',
  'type' => '0',
  'keyword' => 'mysql   load data infile    导入数据',
  'remark' => '我们常常导入数据！mysql有一个高效导入方法，那就是load data infile 下面来看案例说明',
  'content' => '<p><span style="font-size: small;"><span style="color: blue;">基本语法：</span></span></p><p><span style="color: red;"><span style="font-size: small;">load data &nbsp;[low_priority] [local] infile &#39;file_name txt&#39; [replace | ignore]<br/>into table tbl_name<br/>[fields<br/>[terminated by&#39;t&#39;]<br/>[OPTIONALLY] enclosed by &#39;&#39;]<br/>[escaped by&#39;\\&#39; ]]<br/>[lines terminated by&#39;n&#39;]<br/>[ignore number lines]<br/>[(col_name,&nbsp;&nbsp; )]<br/></span></span><span style="color: blue;"><br/></span><span style="font-size: small;"><span style="color: rgb(153, 51, 102);">load data infile</span><span style="color: rgb(153, 51, 102);">语句从一个文本文件中以很高的速度读入一个表中。</span><span style="color: rgb(153, 51, 102);">使用这个命令之前，mysqld进程（服务）必须已经在运行。</span><span style="color: rgb(153, 51, 102);">为了安全原因，当读取位于服务器上的文本文件时，文件必须处于数据库目录或可被所有人读取。另外，为了对服务器上文件使用</span><span style="color: rgb(153, 51, 102);">load data infile</span><span style="color: rgb(153, 51, 102);">，在服务器主机上你必须有</span><span style="color: rgb(153, 51, 102);">file</span><span style="color: rgb(153, 51, 102);">的权限。</span></span></p><p><span style="font-size: small;"><span style="color: blue;">1 &nbsp;</span><span style="color: blue;">如果你指定关键词</span><span style="color: blue;">low_priority</span><span style="color: blue;">，</span></span><span style="color: blue;"><span style="font-size: small;">那么MySQL将会等到没有其他人读这个表的时候，才把插入数据。可以使用如下的命令：</span><span style="font-size: small;">&nbsp;<br/></span></span><span style="font-size: small;"><strong><span style="color: red;">load data &nbsp;low_priority infile &quot;/home/mark/data sql&quot; into table Orders;</span></strong></span></p><p>&nbsp;</p><p><span style="font-size: small;"><span style="color: blue;">2 &nbsp;</span><span style="color: blue;">如果指定</span><span style="color: blue;">local</span><span style="color: blue;">关键词，则表明从客户主机读文件。如果</span><span style="color: blue;">local</span><span style="color: blue;">没指定，文件必须位于服务器上。</span></span></p><p>&nbsp;</p><p><span style="font-size: small;"><span style="color: blue;">3 &nbsp;replace</span><span style="color: blue;">和</span><span style="color: blue;">ignore</span><span style="color: blue;">关键词控制对现有的唯一键记录的重复的处理。如果你指定</span><span style="color: blue;">replace</span><span style="color: blue;">，新行将代替有相同的唯一键值的现有行。如果你指定</span><span style="color: blue;">ignore</span><span style="color: blue;">，跳过有唯一键的现有行的重复行的输入。如果你不指定任何一个选项，当找到重复键时，出现一个错误，并且文本文件的余下部分被忽略。例如：</span></span></p><p><strong><span style="color: red;"><span style="font-size: small;">load data &nbsp;low_priority infile &quot;/home/mark/data sql&quot; replace into table Orders;</span></span></strong></p><p>&nbsp;</p><p><span style="font-size: small;"><span style="color: blue;">4&nbsp;</span><span style="color: blue;">分隔符</span></span></p><p><span style="color: blue;"><span style="font-size: small;">（1） fields关键字指定了文件记段的分割格式，如果用到这个关键字，MySQL剖析器希望看到至少有下面的一个选项：</span><span style="font-size: small;">&nbsp;<br/></span></span><span style="color: purple;"><span style="font-size: small;">terminated by</span></span><span style="color: purple;"><span style="font-size: small;">分隔符：意思是以什么字符作为分隔符</span><br/><span style="font-size: small;">enclosed by</span><span style="font-size: small;">字段括起字符</span><br/><span style="font-size: small;">escaped by</span><span style="font-size: small;">转义字符</span></span></p><p><span style="color: purple;"><span style="font-size: small;">terminated by</span></span><span style="color: purple;"><span style="font-size: small;">描述字段的分隔符，默认情况下是tab字符（\\t）</span><span style="font-size: small;">&nbsp;<br/>enclosed by描述的是字段的括起字符。</span><br/><span style="font-size: small;">escaped by</span><span style="font-size: small;">描述的转义字符。默认的是反斜杠（backslash：\\ ） &nbsp;</span></span></p><p><strong><span style="color: red;"><span style="font-size: small;">例如：load data infile &quot;/home/mark/Orders txt&quot; replace into table Orders fields terminated by&#39;,&#39; enclosed by &#39;&quot;&#39;;</span></span></strong></p><p><span style="font-size: small;"><span style="color: blue;">（2）lines 关键字指定了每条记录的分隔符默认为</span><span style="color: blue;">&#39;\\n&#39;</span><span style="color: blue;">即为换行符</span></span></p><p><span style="font-size: small;"><span style="color: maroon;">如果两个字段都指定了那</span><span style="color: maroon;">fields</span><span style="color: maroon;">必须在</span><span style="color: maroon;">lines</span><span style="color: maroon;">之前。</span><span style="color: maroon;">如果不指定</span><span style="color: maroon;">fields</span><span style="color: maroon;">关键字缺省值与如果你这样写的相同：</span><span style="color: blue;">&nbsp;fields terminated by&#39;\\t&#39; enclosed by ’ &#39;&#39; ‘ escaped by&#39;\\\\&#39;</span></span></p><p><span style="font-size: small;"><span style="color: maroon;">如果你不指定一个</span><span style="color: maroon;">lines</span><span style="color: maroon;">子句，缺省值与如果你这样写的相同：</span><span style="color: blue;">&nbsp;lines terminated by&#39;\\n&#39;</span></span></p><p><span style="font-size: small;"><span style="color: red;">例如：</span><span style="color: red;">load data infile &quot;/jiaoben/load.txt&quot; replace into table test fields terminated by &#39;,&#39; lines terminated by &#39;/n&#39;;</span></span></p><p><span style="font-size: small;"><span style="color: blue;">5&nbsp;</span><span style="color: red;">&nbsp;</span><span style="color: blue;">load data infile&nbsp;</span><span style="color: blue;">可以按指定的列把文件导入到数据库中。 当我们要把数据的一部分内容导入的时候，，需要加入一些栏目（列/字段/field）到MySQL数据库中，以适应一些额外的需要。比方说，我们要从Access数据库升级到MySQL数据库的时候</span></span></p><p><span style="color: blue;"><span style="font-size: small;">下面的例子显示了如何向指定的栏目(field)中导入数据：</span><span style="font-size: small;">&nbsp;<br/></span></span><strong><span style="color: red;"><span style="font-size: small;">load data infile &quot;/home/Order txt&quot; into table Orders(Order_Number, Order_Date, Customer_ID);</span></span></strong></p><p><span style="font-size: small;"><span style="color: blue;">6&nbsp;</span><span style="color: blue;">&nbsp;</span><span style="color: blue;">当在服务器主机上寻找文件时，服务器使用下列规则：</span></span><span style="font-size: small;"><span style="color: blue;">&nbsp;<br/></span><span style="color: blue;">（</span><span style="color: blue;">1</span><span style="color: blue;">）如果给出一个绝对路径名，服务器使用该路径名。</span></span><span style="font-size: small;"><span style="color: blue;">&nbsp;<br/></span><span style="color: blue;">（</span><span style="color: blue;">2</span><span style="color: blue;">）如果给出一个有一个或多个前置部件的相对路径名，服务器相对服务器的数据目录搜索文件。</span></span><span style="color: blue;"><span style="font-size: small;">&nbsp;&nbsp;</span><br/></span><span style="font-size: small;"><span style="color: blue;">（</span><span style="color: blue;">3</span><span style="color: blue;">）如果给出一个没有前置部件的一个文件名，服务器在当前数据库的数据库目录寻找文件。</span></span><span style="font-size: small;"><span style="color: blue;">&nbsp;<br/></span><span style="color: red;">例如：</span><span style="color: red;">&nbsp;/myfile txt”</span><span style="color: red;">给出的文件是从服务器的数据目录读取，而作为</span><span style="color: red;">“myfile txt”</span><span style="color: red;">给出的一个文件是从当前数据库的数据库目录下读取。</span></span></p><p>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: small;"><strong><span style="color: maroon;">注意：字段中的空值用</span></strong><strong><span style="color: maroon;">\\N</span></strong><strong><span style="color: maroon;">表示</span></strong></span></p><p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);"><br/>我的文章一般浅显易懂，不会搞那么深入让大家很难理解。（其实我水平也不咋样)<br/><br/>LOAD DATA INFILE 一直被认为是MySQL很强大的一个数据导入工具，因为他速度非常的快。<br/><span style="color: rgb(255, 1, 2);">不过有几个问题一定要注意</span><br style="color: rgb(255, 1, 2);"/><span style="color: rgb(255, 1, 2);">1、编码。</span><br style="color: rgb(255, 1, 2);"/><span style="color: rgb(255, 1, 2);">2、灵活导入导出。</span><br/><br/>我来举两个例子说明一下。<br/><span style="font-size: x-small;"><span style="color: rgb(0, 1, 255);">一、关于编码</span></span><br/>我们的示例文本文件：<br/><span style="color: rgb(0, 153, 2);">&quot;我爱你&quot;,&quot;20&quot;,&quot;相貌平常，经常耍流氓！哈哈&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;李奎&quot;,&quot;21&quot;,&quot;相貌平常，经常耍流氓！哈哈&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;王二米&quot;,&quot;20&quot;,&quot;相貌平常，经常耍流氓！哈哈&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;老三&quot;,&quot;24&quot;,&quot;很强&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;老四&quot;,&quot;34&quot;,&quot;XXXXX&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;老五&quot;,&quot;52&quot;,&quot;***%*￥*￥*￥*￥&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;小猫&quot;,&quot;45&quot;,&quot;中间省略。。。&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;小狗&quot;,&quot;12&quot;,&quot;就会叫&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;小妹&quot;,&quot;21&quot;,&quot;PP的很&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;小坏蛋&quot;,&quot;52&quot;,&quot;表里不一&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;上帝他爷&quot;,&quot;96&quot;,&quot;非常英俊&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;MM来了&quot;,&quot;10&quot;,&quot;。。。&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;歌颂党&quot;,&quot;20&quot;,&quot;社会主义好&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;人民好&quot;,&quot;20&quot;,&quot;的确是好&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;老高&quot;,&quot;10&quot;,&quot;学习很好&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;斜三&quot;,&quot;60&quot;,&quot;眼睛斜了&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;中华之子&quot;,&quot;100&quot;,&quot;威武的不行了&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;大米&quot;,&quot;63&quot;,&quot;我爱吃&quot;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&quot;苹果&quot;,&quot;15&quot;,&quot;好吃&quot;</span><br/>我们的示例表结构：<br/><br/><br/><span style="color: rgb(0, 153, 2);">+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">| Table | Create Table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">| t0&nbsp;&nbsp;&nbsp; | CREATE TABLE `t0` (</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp; `id` bigint(20) unsigned NOT NULL auto_increment,</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp; `name` char(20) NOT NULL,</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp; `age` tinyint(3) unsigned NOT NULL,</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp; `description` text NOT NULL,</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp; PRIMARY KEY&nbsp; (`id`),</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp; UNIQUE KEY `idx_name` (`name`)</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">) ENGINE=MyISAM DEFAULT CHARSET=utf8 |&nbsp;</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">1 row in set (0.00 sec)</span><br/><br/><br/>我们把这个文本文件从WINDOWS 下COPY到LINUX下看看<br/><br/><br style="color: rgb(0, 1, 255);"/><span style="color: rgb(0, 1, 255);">mysql&gt; load data infile &#39;/tmp/t0.txt&#39; ignore into table t0 character set gbk fields terminated by &#39;,&#39; enclosed by &#39;&quot;&#39; lines terminated by &#39;\\n&#39; (`name`,`age`,`description`);</span><br/>Query OK, 19 rows affected (0.01 sec)<br/>Records: 19&nbsp; Deleted: 0&nbsp; Skipped: 0&nbsp; Warnings: 0<br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+<br/>|&nbsp; 1 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>|&nbsp; 2 | 李奎&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>|&nbsp; 3 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>|&nbsp; 4 | 老三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 24 | 很强&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 5 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 6 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 7 | 小猫&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 45 | 中间省略。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 8 | 小狗&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 12 | 就会叫&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 9 | 小妹&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | PP的很&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 10 | 小坏蛋&nbsp;&nbsp; |&nbsp; 52 | 表里不一&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 11 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 12 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 13 | 歌颂党&nbsp;&nbsp; |&nbsp; 20 | 社会主义好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 14 | 人民好&nbsp;&nbsp; |&nbsp; 20 | 的确是好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 15 | 老高&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 10 | 学习很好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 16 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 17 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 18 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 19 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>+----+----------+-----+----------------------------+<br/>19 rows in set (0.00 sec)<br/><br/><span style="color: rgb(255, 1, 2);">我来说明一下相关的参数</span><br/>关于我的导入语句，我现在直说两个，其他的参考手册。<br/><span style="color: rgb(0, 153, 2);">character set gbk;</span><br/><br/>这个字符集一定要写，要不然就会乱码或者只导入一部分数据。<br/><br/><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">ignore into table&nbsp;</span><br/><br/><br/>因为name 列加了唯一索引，加这个是为了避免重复数据插入报错。<br/><br/>加入我们再次运行这个导入语句就会发现<br/>Query OK, 0 rows affected (0.00 sec)<br/>Records: 19&nbsp; Deleted: 0&nbsp; Skipped: 19&nbsp; Warnings: 0<br/>没有任何值导入，因为里面已经有了相同的值。<br/><br/>这里也可以用<span style="color: rgb(0, 153, 2);">replace into table</span><br/>MySQL会把相同的先干掉，再插入新的值。<br/><span style="color: rgb(0, 1, 255);">mysql&gt; load data infile &#39;/tmp/t0.txt&#39; replace into table t0 character set gbk fields terminated by &#39;,&#39; enclosed by &#39;&quot;&#39; lines terminated by &#39;\\n&#39; (`name`,`age`,`description`);</span><br/>Query OK, 38 rows affected (0.00 sec)<br/>Records: 19&nbsp; Deleted: 19&nbsp; Skipped: 0&nbsp; Warnings: 0<br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+<br/>| 20 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>| 21 | 李奎&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>| 22 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>| 23 | 老三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 24 | 很强&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 24 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 25 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 26 | 小猫&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 45 | 中间省略。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 27 | 小狗&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 12 | 就会叫&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 28 | 小妹&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | PP的很&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 29 | 小坏蛋&nbsp;&nbsp; |&nbsp; 52 | 表里不一&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 30 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 31 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 32 | 歌颂党&nbsp;&nbsp; |&nbsp; 20 | 社会主义好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 33 | 人民好&nbsp;&nbsp; |&nbsp; 20 | 的确是好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 34 | 老高&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 10 | 学习很好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 35 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 36 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 37 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 38 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>+----+----------+-----+----------------------------+<br/>19 rows in set (0.00 sec)<br/><br/><br style="color: rgb(0, 153, 2);"/><span style="color: rgb(0, 153, 2);">&nbsp;(`name`,`age`,`description`);</span><br/><br/>这些也就是具体的表属性了，指明这个就可以导入想要的数据。<br/><span style="font-size: x-small;"><span style="color: rgb(0, 1, 255);">2、关于灵活性，其实也就是一个记录功能</span></span><br/>如果想在导入的时候记录一下导入的具体时间怎么办？<br/>我们来看看<br/>先加一个时间属性记录导入时间。<br/><span style="color: rgb(0, 1, 255);">mysql&gt; alter table t0 add update_time timestamp not null;</span><br/>Query OK, 19 rows affected (0.00 sec)<br/>Records: 19&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/>干掉唯一索引<br/><span style="color: rgb(0, 1, 255);">mysql&gt; alter table t0 drop index idx_name;</span><br/>Query OK, 19 rows affected (0.00 sec)<br/>Records: 19&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/><br/><br style="color: rgb(0, 1, 255);"/><span style="color: rgb(0, 1, 255);">mysql&gt; load data infile &#39;/tmp/t0.txt&#39; into table t0 character set gbk fields terminated by &#39;,&#39; enclosed by &#39;&quot;&#39; lines terminated by &#39;\\n&#39; (`name`,`age`,`description`) set update_time=current_timestamp;</span><br/>Query OK, 19 rows affected (0.00 sec)<br/>Records: 19&nbsp; Deleted: 0&nbsp; Skipped: 0&nbsp; Warnings: 0<br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+---------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | update_time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+---------------------+<br/>| 20 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 0000-00-00 00:00:00 |&nbsp;<br/>…………<br/>| 24 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>| 25 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>…………<br/>| 35 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>| 36 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>…………<br/>| 60 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>…………<br/>| 68 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 69 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>…………<br/>| 75 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 76 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>+----+----------+-----+----------------------------+---------------------+<br/>38 rows in set (0.00 sec)<br/><br/><br/>新导入的19条记录时间被记录了下来。<br/>只是之前的数据库没有记录，不过现在不需要这些重复数据了。<br/><br/>干掉他就可以了<br/><br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; alter table t0 order by id desc;</span><br/>Query OK, 38 rows affected (0.01 sec)<br/>Records: 38&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; alter ignore table t0 add unique index idx_name (`name`);</span><br/>Query OK, 38 rows affected (0.00 sec)<br/>Records: 38&nbsp; Duplicates: 19&nbsp; Warnings: 0<br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; alter table t0 order by id asc;</span><br/>Query OK, 19 rows affected (0.01 sec)<br/>Records: 19&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/><br/><span style="color: rgb(0, 1, 255);">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+---------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | update_time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+---------------------+<br/>| 58 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>| 59 | 李奎&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>| 60 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>| 61 | 老三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 24 | 很强&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 62 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 63 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 64 | 小猫&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 45 | 中间省略。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 65 | 小狗&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 12 | 就会叫&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 66 | 小妹&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | PP的很&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 67 | 小坏蛋&nbsp;&nbsp; |&nbsp; 52 | 表里不一&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 68 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 69 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 70 | 歌颂党&nbsp;&nbsp; |&nbsp; 20 | 社会主义好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 71 | 人民好&nbsp;&nbsp; |&nbsp; 20 | 的确是好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 72 | 老高&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 10 | 学习很好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 73 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 74 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 75 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 76 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>+----+----------+-----+----------------------------+---------------------+<br/>19 rows in set (0.00 sec)<br/><br/>现在是达到了目的了，为啥中途要干掉唯一索引呢？因为set 语法 再有IGNORE 的时候会忽略掉。</p><p><br/></p>',
  'is_tui' => '1',
  'status' => '1',
  'views' => '1',
  'auth' => '韩会强',
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000314s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000862s ]
[ sql ] [ SQL ] INSERT INTO `think_article` (`title` , `cate_id` , `type` , `keyword` , `remark` , `content` , `is_tui` , `status` , `views` , `auth` , `photo` , `ip` , `update_time` , `create_time`) VALUES ('mysql导入数据load data infile用法' , 22 , 0 , 'mysql   load data infile    导入数据' , '我们常常导入数据！mysql有一个高效导入方法，那就是load data infile 下面来看案例说明' , '<p><span style=\"font-size: small;\"><span style=\"color: blue;\">基本语法：</span></span></p><p><span style=\"color: red;\"><span style=\"font-size: small;\">load data &nbsp;[low_priority] [local] infile &#39;file_name txt&#39; [replace | ignore]<br/>into table tbl_name<br/>[fields<br/>[terminated by&#39;t&#39;]<br/>[OPTIONALLY] enclosed by &#39;&#39;]<br/>[escaped by&#39;\\&#39; ]]<br/>[lines terminated by&#39;n&#39;]<br/>[ignore number lines]<br/>[(col_name,&nbsp;&nbsp; )]<br/></span></span><span style=\"color: blue;\"><br/></span><span style=\"font-size: small;\"><span style=\"color: rgb(153, 51, 102);\">load data infile</span><span style=\"color: rgb(153, 51, 102);\">语句从一个文本文件中以很高的速度读入一个表中。</span><span style=\"color: rgb(153, 51, 102);\">使用这个命令之前，mysqld进程（服务）必须已经在运行。</span><span style=\"color: rgb(153, 51, 102);\">为了安全原因，当读取位于服务器上的文本文件时，文件必须处于数据库目录或可被所有人读取。另外，为了对服务器上文件使用</span><span style=\"color: rgb(153, 51, 102);\">load data infile</span><span style=\"color: rgb(153, 51, 102);\">，在服务器主机上你必须有</span><span style=\"color: rgb(153, 51, 102);\">file</span><span style=\"color: rgb(153, 51, 102);\">的权限。</span></span></p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">1 &nbsp;</span><span style=\"color: blue;\">如果你指定关键词</span><span style=\"color: blue;\">low_priority</span><span style=\"color: blue;\">，</span></span><span style=\"color: blue;\"><span style=\"font-size: small;\">那么MySQL将会等到没有其他人读这个表的时候，才把插入数据。可以使用如下的命令：</span><span style=\"font-size: small;\">&nbsp;<br/></span></span><span style=\"font-size: small;\"><strong><span style=\"color: red;\">load data &nbsp;low_priority infile &quot;/home/mark/data sql&quot; into table Orders;</span></strong></span></p><p>&nbsp;</p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">2 &nbsp;</span><span style=\"color: blue;\">如果指定</span><span style=\"color: blue;\">local</span><span style=\"color: blue;\">关键词，则表明从客户主机读文件。如果</span><span style=\"color: blue;\">local</span><span style=\"color: blue;\">没指定，文件必须位于服务器上。</span></span></p><p>&nbsp;</p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">3 &nbsp;replace</span><span style=\"color: blue;\">和</span><span style=\"color: blue;\">ignore</span><span style=\"color: blue;\">关键词控制对现有的唯一键记录的重复的处理。如果你指定</span><span style=\"color: blue;\">replace</span><span style=\"color: blue;\">，新行将代替有相同的唯一键值的现有行。如果你指定</span><span style=\"color: blue;\">ignore</span><span style=\"color: blue;\">，跳过有唯一键的现有行的重复行的输入。如果你不指定任何一个选项，当找到重复键时，出现一个错误，并且文本文件的余下部分被忽略。例如：</span></span></p><p><strong><span style=\"color: red;\"><span style=\"font-size: small;\">load data &nbsp;low_priority infile &quot;/home/mark/data sql&quot; replace into table Orders;</span></span></strong></p><p>&nbsp;</p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">4&nbsp;</span><span style=\"color: blue;\">分隔符</span></span></p><p><span style=\"color: blue;\"><span style=\"font-size: small;\">（1） fields关键字指定了文件记段的分割格式，如果用到这个关键字，MySQL剖析器希望看到至少有下面的一个选项：</span><span style=\"font-size: small;\">&nbsp;<br/></span></span><span style=\"color: purple;\"><span style=\"font-size: small;\">terminated by</span></span><span style=\"color: purple;\"><span style=\"font-size: small;\">分隔符：意思是以什么字符作为分隔符</span><br/><span style=\"font-size: small;\">enclosed by</span><span style=\"font-size: small;\">字段括起字符</span><br/><span style=\"font-size: small;\">escaped by</span><span style=\"font-size: small;\">转义字符</span></span></p><p><span style=\"color: purple;\"><span style=\"font-size: small;\">terminated by</span></span><span style=\"color: purple;\"><span style=\"font-size: small;\">描述字段的分隔符，默认情况下是tab字符（\\t）</span><span style=\"font-size: small;\">&nbsp;<br/>enclosed by描述的是字段的括起字符。</span><br/><span style=\"font-size: small;\">escaped by</span><span style=\"font-size: small;\">描述的转义字符。默认的是反斜杠（backslash：\\ ） &nbsp;</span></span></p><p><strong><span style=\"color: red;\"><span style=\"font-size: small;\">例如：load data infile &quot;/home/mark/Orders txt&quot; replace into table Orders fields terminated by&#39;,&#39; enclosed by &#39;&quot;&#39;;</span></span></strong></p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">（2）lines 关键字指定了每条记录的分隔符默认为</span><span style=\"color: blue;\">&#39;\\n&#39;</span><span style=\"color: blue;\">即为换行符</span></span></p><p><span style=\"font-size: small;\"><span style=\"color: maroon;\">如果两个字段都指定了那</span><span style=\"color: maroon;\">fields</span><span style=\"color: maroon;\">必须在</span><span style=\"color: maroon;\">lines</span><span style=\"color: maroon;\">之前。</span><span style=\"color: maroon;\">如果不指定</span><span style=\"color: maroon;\">fields</span><span style=\"color: maroon;\">关键字缺省值与如果你这样写的相同：</span><span style=\"color: blue;\">&nbsp;fields terminated by&#39;\\t&#39; enclosed by ’ &#39;&#39; ‘ escaped by&#39;\\\\&#39;</span></span></p><p><span style=\"font-size: small;\"><span style=\"color: maroon;\">如果你不指定一个</span><span style=\"color: maroon;\">lines</span><span style=\"color: maroon;\">子句，缺省值与如果你这样写的相同：</span><span style=\"color: blue;\">&nbsp;lines terminated by&#39;\\n&#39;</span></span></p><p><span style=\"font-size: small;\"><span style=\"color: red;\">例如：</span><span style=\"color: red;\">load data infile &quot;/jiaoben/load.txt&quot; replace into table test fields terminated by &#39;,&#39; lines terminated by &#39;/n&#39;;</span></span></p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">5&nbsp;</span><span style=\"color: red;\">&nbsp;</span><span style=\"color: blue;\">load data infile&nbsp;</span><span style=\"color: blue;\">可以按指定的列把文件导入到数据库中。 当我们要把数据的一部分内容导入的时候，，需要加入一些栏目（列/字段/field）到MySQL数据库中，以适应一些额外的需要。比方说，我们要从Access数据库升级到MySQL数据库的时候</span></span></p><p><span style=\"color: blue;\"><span style=\"font-size: small;\">下面的例子显示了如何向指定的栏目(field)中导入数据：</span><span style=\"font-size: small;\">&nbsp;<br/></span></span><strong><span style=\"color: red;\"><span style=\"font-size: small;\">load data infile &quot;/home/Order txt&quot; into table Orders(Order_Number, Order_Date, Customer_ID);</span></span></strong></p><p><span style=\"font-size: small;\"><span style=\"color: blue;\">6&nbsp;</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: blue;\">当在服务器主机上寻找文件时，服务器使用下列规则：</span></span><span style=\"font-size: small;\"><span style=\"color: blue;\">&nbsp;<br/></span><span style=\"color: blue;\">（</span><span style=\"color: blue;\">1</span><span style=\"color: blue;\">）如果给出一个绝对路径名，服务器使用该路径名。</span></span><span style=\"font-size: small;\"><span style=\"color: blue;\">&nbsp;<br/></span><span style=\"color: blue;\">（</span><span style=\"color: blue;\">2</span><span style=\"color: blue;\">）如果给出一个有一个或多个前置部件的相对路径名，服务器相对服务器的数据目录搜索文件。</span></span><span style=\"color: blue;\"><span style=\"font-size: small;\">&nbsp;&nbsp;</span><br/></span><span style=\"font-size: small;\"><span style=\"color: blue;\">（</span><span style=\"color: blue;\">3</span><span style=\"color: blue;\">）如果给出一个没有前置部件的一个文件名，服务器在当前数据库的数据库目录寻找文件。</span></span><span style=\"font-size: small;\"><span style=\"color: blue;\">&nbsp;<br/></span><span style=\"color: red;\">例如：</span><span style=\"color: red;\">&nbsp;/myfile txt”</span><span style=\"color: red;\">给出的文件是从服务器的数据目录读取，而作为</span><span style=\"color: red;\">“myfile txt”</span><span style=\"color: red;\">给出的一个文件是从当前数据库的数据库目录下读取。</span></span></p><p>&nbsp;</p><p>&nbsp;</p><p><span style=\"font-size: small;\"><strong><span style=\"color: maroon;\">注意：字段中的空值用</span></strong><strong><span style=\"color: maroon;\">\\N</span></strong><strong><span style=\"color: maroon;\">表示</span></strong></span></p><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/>我的文章一般浅显易懂，不会搞那么深入让大家很难理解。（其实我水平也不咋样)<br/><br/>LOAD DATA INFILE 一直被认为是MySQL很强大的一个数据导入工具，因为他速度非常的快。<br/><span style=\"color: rgb(255, 1, 2);\">不过有几个问题一定要注意</span><br style=\"color: rgb(255, 1, 2);\"/><span style=\"color: rgb(255, 1, 2);\">1、编码。</span><br style=\"color: rgb(255, 1, 2);\"/><span style=\"color: rgb(255, 1, 2);\">2、灵活导入导出。</span><br/><br/>我来举两个例子说明一下。<br/><span style=\"font-size: x-small;\"><span style=\"color: rgb(0, 1, 255);\">一、关于编码</span></span><br/>我们的示例文本文件：<br/><span style=\"color: rgb(0, 153, 2);\">&quot;我爱你&quot;,&quot;20&quot;,&quot;相貌平常，经常耍流氓！哈哈&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;李奎&quot;,&quot;21&quot;,&quot;相貌平常，经常耍流氓！哈哈&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;王二米&quot;,&quot;20&quot;,&quot;相貌平常，经常耍流氓！哈哈&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;老三&quot;,&quot;24&quot;,&quot;很强&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;老四&quot;,&quot;34&quot;,&quot;XXXXX&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;老五&quot;,&quot;52&quot;,&quot;***%*￥*￥*￥*￥&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;小猫&quot;,&quot;45&quot;,&quot;中间省略。。。&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;小狗&quot;,&quot;12&quot;,&quot;就会叫&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;小妹&quot;,&quot;21&quot;,&quot;PP的很&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;小坏蛋&quot;,&quot;52&quot;,&quot;表里不一&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;上帝他爷&quot;,&quot;96&quot;,&quot;非常英俊&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;MM来了&quot;,&quot;10&quot;,&quot;。。。&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;歌颂党&quot;,&quot;20&quot;,&quot;社会主义好&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;人民好&quot;,&quot;20&quot;,&quot;的确是好&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;老高&quot;,&quot;10&quot;,&quot;学习很好&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;斜三&quot;,&quot;60&quot;,&quot;眼睛斜了&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;中华之子&quot;,&quot;100&quot;,&quot;威武的不行了&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;大米&quot;,&quot;63&quot;,&quot;我爱吃&quot;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&quot;苹果&quot;,&quot;15&quot;,&quot;好吃&quot;</span><br/>我们的示例表结构：<br/><br/><br/><span style=\"color: rgb(0, 153, 2);\">+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">| Table | Create Table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">| t0&nbsp;&nbsp;&nbsp; | CREATE TABLE `t0` (</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp; `id` bigint(20) unsigned NOT NULL auto_increment,</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp; `name` char(20) NOT NULL,</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp; `age` tinyint(3) unsigned NOT NULL,</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp; `description` text NOT NULL,</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp; PRIMARY KEY&nbsp; (`id`),</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp; UNIQUE KEY `idx_name` (`name`)</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">) ENGINE=MyISAM DEFAULT CHARSET=utf8 |&nbsp;</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">1 row in set (0.00 sec)</span><br/><br/><br/>我们把这个文本文件从WINDOWS 下COPY到LINUX下看看<br/><br/><br style=\"color: rgb(0, 1, 255);\"/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; load data infile &#39;/tmp/t0.txt&#39; ignore into table t0 character set gbk fields terminated by &#39;,&#39; enclosed by &#39;&quot;&#39; lines terminated by &#39;\\n&#39; (`name`,`age`,`description`);</span><br/>Query OK, 19 rows affected (0.01 sec)<br/>Records: 19&nbsp; Deleted: 0&nbsp; Skipped: 0&nbsp; Warnings: 0<br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+<br/>|&nbsp; 1 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>|&nbsp; 2 | 李奎&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>|&nbsp; 3 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>|&nbsp; 4 | 老三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 24 | 很强&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 5 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 6 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 7 | 小猫&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 45 | 中间省略。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 8 | 小狗&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 12 | 就会叫&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>|&nbsp; 9 | 小妹&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | PP的很&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 10 | 小坏蛋&nbsp;&nbsp; |&nbsp; 52 | 表里不一&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 11 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 12 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 13 | 歌颂党&nbsp;&nbsp; |&nbsp; 20 | 社会主义好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 14 | 人民好&nbsp;&nbsp; |&nbsp; 20 | 的确是好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 15 | 老高&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 10 | 学习很好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 16 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 17 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 18 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 19 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>+----+----------+-----+----------------------------+<br/>19 rows in set (0.00 sec)<br/><br/><span style=\"color: rgb(255, 1, 2);\">我来说明一下相关的参数</span><br/>关于我的导入语句，我现在直说两个，其他的参考手册。<br/><span style=\"color: rgb(0, 153, 2);\">character set gbk;</span><br/><br/>这个字符集一定要写，要不然就会乱码或者只导入一部分数据。<br/><br/><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">ignore into table&nbsp;</span><br/><br/><br/>因为name 列加了唯一索引，加这个是为了避免重复数据插入报错。<br/><br/>加入我们再次运行这个导入语句就会发现<br/>Query OK, 0 rows affected (0.00 sec)<br/>Records: 19&nbsp; Deleted: 0&nbsp; Skipped: 19&nbsp; Warnings: 0<br/>没有任何值导入，因为里面已经有了相同的值。<br/><br/>这里也可以用<span style=\"color: rgb(0, 153, 2);\">replace into table</span><br/>MySQL会把相同的先干掉，再插入新的值。<br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; load data infile &#39;/tmp/t0.txt&#39; replace into table t0 character set gbk fields terminated by &#39;,&#39; enclosed by &#39;&quot;&#39; lines terminated by &#39;\\n&#39; (`name`,`age`,`description`);</span><br/>Query OK, 38 rows affected (0.00 sec)<br/>Records: 19&nbsp; Deleted: 19&nbsp; Skipped: 0&nbsp; Warnings: 0<br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+<br/>| 20 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>| 21 | 李奎&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>| 22 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 |&nbsp;<br/>| 23 | 老三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 24 | 很强&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 24 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 25 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 26 | 小猫&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 45 | 中间省略。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 27 | 小狗&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 12 | 就会叫&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 28 | 小妹&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | PP的很&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 29 | 小坏蛋&nbsp;&nbsp; |&nbsp; 52 | 表里不一&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 30 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 31 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 32 | 歌颂党&nbsp;&nbsp; |&nbsp; 20 | 社会主义好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 33 | 人民好&nbsp;&nbsp; |&nbsp; 20 | 的确是好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 34 | 老高&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 10 | 学习很好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 35 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 36 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 37 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>| 38 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br/>+----+----------+-----+----------------------------+<br/>19 rows in set (0.00 sec)<br/><br/><br style=\"color: rgb(0, 153, 2);\"/><span style=\"color: rgb(0, 153, 2);\">&nbsp;(`name`,`age`,`description`);</span><br/><br/>这些也就是具体的表属性了，指明这个就可以导入想要的数据。<br/><span style=\"font-size: x-small;\"><span style=\"color: rgb(0, 1, 255);\">2、关于灵活性，其实也就是一个记录功能</span></span><br/>如果想在导入的时候记录一下导入的具体时间怎么办？<br/>我们来看看<br/>先加一个时间属性记录导入时间。<br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; alter table t0 add update_time timestamp not null;</span><br/>Query OK, 19 rows affected (0.00 sec)<br/>Records: 19&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/>干掉唯一索引<br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; alter table t0 drop index idx_name;</span><br/>Query OK, 19 rows affected (0.00 sec)<br/>Records: 19&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/><br/><br style=\"color: rgb(0, 1, 255);\"/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; load data infile &#39;/tmp/t0.txt&#39; into table t0 character set gbk fields terminated by &#39;,&#39; enclosed by &#39;&quot;&#39; lines terminated by &#39;\\n&#39; (`name`,`age`,`description`) set update_time=current_timestamp;</span><br/>Query OK, 19 rows affected (0.00 sec)<br/>Records: 19&nbsp; Deleted: 0&nbsp; Skipped: 0&nbsp; Warnings: 0<br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+---------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | update_time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+---------------------+<br/>| 20 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 0000-00-00 00:00:00 |&nbsp;<br/>…………<br/>| 24 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>| 25 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>…………<br/>| 35 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>| 36 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0000-00-00 00:00:00 |&nbsp;<br/>…………<br/>| 60 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>…………<br/>| 68 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 69 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>…………<br/>| 75 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 76 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>+----+----------+-----+----------------------------+---------------------+<br/>38 rows in set (0.00 sec)<br/><br/><br/>新导入的19条记录时间被记录了下来。<br/>只是之前的数据库没有记录，不过现在不需要这些重复数据了。<br/><br/>干掉他就可以了<br/><br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; alter table t0 order by id desc;</span><br/>Query OK, 38 rows affected (0.01 sec)<br/>Records: 38&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; alter ignore table t0 add unique index idx_name (`name`);</span><br/>Query OK, 38 rows affected (0.00 sec)<br/>Records: 38&nbsp; Duplicates: 19&nbsp; Warnings: 0<br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; alter table t0 order by id asc;</span><br/>Query OK, 19 rows affected (0.01 sec)<br/>Records: 19&nbsp; Duplicates: 0&nbsp; Warnings: 0<br/><br/><span style=\"color: rgb(0, 1, 255);\">mysql&gt; select * from t0;</span><br/>+----+----------+-----+----------------------------+---------------------+<br/>| id | name&nbsp;&nbsp;&nbsp;&nbsp; | age | description&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | update_time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>+----+----------+-----+----------------------------+---------------------+<br/>| 58 | 我爱你&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>| 59 | 李奎&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>| 60 | 王二米&nbsp;&nbsp; |&nbsp; 20 | 相貌平常，经常耍流氓！哈哈 | 2008-06-30 14:58:37 |&nbsp;<br/>| 61 | 老三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 24 | 很强&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 62 | 老四&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 34 | XXXXX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 63 | 老五&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 52 | ***%*￥*￥*￥*￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 64 | 小猫&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 45 | 中间省略。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 65 | 小狗&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 12 | 就会叫&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 66 | 小妹&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 21 | PP的很&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 67 | 小坏蛋&nbsp;&nbsp; |&nbsp; 52 | 表里不一&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 68 | 上帝他爷 |&nbsp; 96 | 非常英俊&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 69 | MM来了&nbsp;&nbsp; |&nbsp; 10 | 。。。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 70 | 歌颂党&nbsp;&nbsp; |&nbsp; 20 | 社会主义好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 71 | 人民好&nbsp;&nbsp; |&nbsp; 20 | 的确是好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 72 | 老高&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 10 | 学习很好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 73 | 斜三&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 60 | 眼睛斜了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 74 | 中华之子 | 100 | 威武的不行了&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 75 | 大米&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 63 | 我爱吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>| 76 | 苹果&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; 15 | 好吃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2008-06-30 14:58:37 |&nbsp;<br/>+----+----------+-----+----------------------------+---------------------+<br/>19 rows in set (0.00 sec)<br/><br/>现在是达到了目的了，为啥中途要干掉唯一索引呢？因为set 语法 再有IGNORE 的时候会忽略掉。</p><p><br/></p>' , 1 , 1 , 1 , '韩会强' , 'images/j5uojg6g_2yu9pr4rsd4p59817c795f630.jpg' , '123.233.116.122' , 1501658233 , 1501658233) [ RunTime:0.003771s ]

---------------------------------------------------------------
[ 2017-08-02T15:17:15+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] www.hhqblog.com/admin/article/index.html [运行时间：0.026964s][吞吐率：37.09req/s] [内存消耗：3,813.73kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000332s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000827s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000174s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000938s ]

---------------------------------------------------------------
[ 2017-08-02T15:17:15+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] www.hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.033201s][吞吐率：30.12req/s] [内存消耗：3,744.88kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000341s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000858s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000161s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000973s ]

---------------------------------------------------------------
[ 2017-08-02T15:37:48+08:00 ] 172.17.180.47 107.150.59.98 GET /
[ log ] www.hhqblog.com/ [运行时间：0.035286s][吞吐率：28.34req/s] [内存消耗：5,638.27kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'accept' => 'text/html,text/plain,text/xml,text/*,application/xml,application/xhtml+xml,application/rss+xml,application/atom+xml,application/rdf+xml,application/php,application/x-php,application/x-httpd-php',
  'user-agent' => 'Mozilla/5.0 (compatible; MJ12bot/v1.4.7; http://mj12bot.com/)',
  'accept-language' => 'en',
  'host' => 'www.hhqblog.com',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000299s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000824s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.001002s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000523s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000418s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000338s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000282s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000622s ]

---------------------------------------------------------------
[ 2017-08-02T15:45:19+08:00 ] 172.17.180.47 123.233.116.122 GET /
[ log ] www.hhqblog.com/ [运行时间：0.032868s][吞吐率：30.42req/s] [内存消耗：5,683.10kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'https://www.baidu.com/link?url=8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R&wd=&eqid=b0164bdb000082eb00000002598182fb',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000307s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000850s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000594s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000388s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000286s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000722s ]

---------------------------------------------------------------
[ 2017-08-02T15:45:19+08:00 ] 172.17.180.47 123.233.116.122 GET /index/index/index.html?page=1
[ log ] www.hhqblog.com/index/index/index.html?page=1 [运行时间：0.041705s][吞吐率：23.98req/s] [内存消耗：5,657.63kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://www.hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501655853%2C%22http%3A%2F%2Fhhqblog.com%2F%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.2.1501655853.1501655853.',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000287s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000806s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000568s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000372s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000264s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000761s ]

---------------------------------------------------------------
[ 2017-08-02T15:45:47+08:00 ] 172.17.180.47 123.233.116.122 GET /ar/18.html
[ log ] www.hhqblog.com/ar/18.html [运行时间：0.029494s][吞吐率：33.91req/s] [内存消耗：4,571.70kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659921.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '18',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000288s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000806s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000569s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 18 LIMIT 1 [ RunTime:0.000256s ]

---------------------------------------------------------------
[ 2017-08-02T15:48:00+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/add_article.html
[ log ] www.hhqblog.com/admin/article/add_article.html [运行时间：0.031868s][吞吐率：31.38req/s] [内存消耗：2,987.20kb] [文件加载：51]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/add_article.html [ array (
  0 => 'cates',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000391s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article_cate` [ RunTime:0.000969s ]
[ sql ] [ SQL ] SELECT `id`,`name` FROM `think_article_cate` [ RunTime:0.000259s ]

---------------------------------------------------------------
[ 2017-08-02T15:49:40+08:00 ] 172.17.180.47 14.116.140.8 GET /
[ log ] www.hhqblog.com/ [运行时间：0.033882s][吞吐率：29.51req/s] [内存消耗：5,671.84kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, ss/480x800,text/vnd.wap.wml;q=0.6,UC/28',
  'accept-encoding' => 'gzip,deflate',
  'clientip' => '10.52.127.208',
  'x-real-ip' => '140.205.30.120',
  'user-agent' => 'Mozilla/5.0 (Linux; U; Android 4.3; zh-CN; SCH-N719 Build/JSS15J) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 UCBrowser/9.9.5.489 U3/0.8.0 Mobile Safari/533.1',
  'accept-language' => 'zh-cn',
  'accept-charset' => 'x-gbk,utf-8;q=0.7,*;q=0.7',
  'cache-control' => 'max-age=259200',
  'connection' => 'keep-alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000316s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000846s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000571s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000379s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000353s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000277s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000758s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:04+08:00 ] 172.17.180.47 123.233.116.122 POST /admin/article/add_article.html
[ log ] www.hhqblog.com/admin/article/add_article.html [运行时间：1.981423s][吞吐率：0.50req/s] [内存消耗：3,657.42kb] [文件加载：61]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'add_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'content-length' => '406964',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://www.hhqblog.com',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'content-type' => 'multipart/form-data; boundary=----WebKitFormBoundaryogSKi2MYxBD8VN46',
  'referer' => 'http://www.hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
)
[ info ] [ PARAM ] array (
  'title' => 'php中将二级分类归于一级分类下（非循环查表）',
  'cate_id' => '',
  'type' => '0',
  'keyword' => 'php中将二级分类归于一级分类下（非循环查表）',
  'remark' => 'php中将二级分类归于一级分类下（非循环查表）',
  'content' => '<pre class="brush:php;toolbar:false">我会这样做：
先排序取出来，
$a&nbsp;=&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;3,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工xx&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;4,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1xx&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],

];
$b&nbsp;=&nbsp;[];
foreach&nbsp;($a&nbsp;as&nbsp;$v)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($v[&#39;parentid&#39;]&nbsp;==&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;id&#39;]]&nbsp;=&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;$v[&#39;id&#39;],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;$v[&#39;categoryname&#39;],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;work_list2&#39;&nbsp;=&gt;&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;parentid&#39;]][&#39;work_list2&#39;][]&nbsp;=&nbsp;$v;
&nbsp;&nbsp;&nbsp;&nbsp;}
}

$b&nbsp;=&nbsp;array_values($b);</pre><p><br/></p>',
  'is_tui' => '1',
  'status' => '1',
  'views' => '1',
  'auth' => '韩会强',
)
[ info ] [ RUN ] app\admin\controller\Article->add_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000322s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000827s ]
[ sql ] [ SQL ] INSERT INTO `think_article` (`title` , `cate_id` , `type` , `keyword` , `remark` , `content` , `is_tui` , `status` , `views` , `auth` , `photo` , `ip` , `update_time` , `create_time`) VALUES ('php中将二级分类归于一级分类下（非循环查表）' , 0 , 0 , 'php中将二级分类归于一级分类下（非循环查表）' , 'php中将二级分类归于一级分类下（非循环查表）' , '<pre class=\"brush:php;toolbar:false\">我会这样做：\r\n先排序取出来，\r\n$a&nbsp;=&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;1,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工&#39;\r\n&nbsp;&nbsp;&nbsp;&nbsp;],\r\n&nbsp;&nbsp;&nbsp;&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;2,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1&#39;\r\n&nbsp;&nbsp;&nbsp;&nbsp;],\r\n&nbsp;&nbsp;&nbsp;&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;3,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;1,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工xx&#39;\r\n&nbsp;&nbsp;&nbsp;&nbsp;],\r\n&nbsp;&nbsp;&nbsp;&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;4,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;2,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1xx&#39;\r\n&nbsp;&nbsp;&nbsp;&nbsp;],\r\n\r\n];\r\n$b&nbsp;=&nbsp;[];\r\nforeach&nbsp;($a&nbsp;as&nbsp;$v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($v[&#39;parentid&#39;]&nbsp;==&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;id&#39;]]&nbsp;=&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;$v[&#39;id&#39;],\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;$v[&#39;categoryname&#39;],\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;work_list2&#39;&nbsp;=&gt;&nbsp;[]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;parentid&#39;]][&#39;work_list2&#39;][]&nbsp;=&nbsp;$v;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n\r\n$b&nbsp;=&nbsp;array_values($b);</pre><p><br/></p>' , 1 , 1 , 1 , '韩会强' , 'images/j5uppngw_58cozl37eucq5981842aa8253.jpg' , '123.233.116.122' , 1501660202 , 1501660202) [ RunTime:0.003020s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:06+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] www.hhqblog.com/admin/article/index.html [运行时间：0.026889s][吞吐率：37.19req/s] [内存消耗：3,818.66kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin/article/add_article.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000309s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000821s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000157s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000922s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:06+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] www.hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.031131s][吞吐率：32.12req/s] [内存消耗：3,749.51kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000297s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000817s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000167s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000933s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:12+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/edit_article/id/40/html
[ log ] www.hhqblog.com/admin/article/edit_article/id/40/html [运行时间：0.024057s][吞吐率：41.57req/s] [内存消耗：3,010.46kb] [文件加载：51]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'edit_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '40',
)
[ info ] [ RUN ] app\admin\controller\Article->edit_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/edit_article.html [ array (
  0 => 'article',
  1 => 'cates',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000293s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000807s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `id` = 40 LIMIT 1 [ RunTime:0.000291s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article_cate` [ RunTime:0.000531s ]
[ sql ] [ SQL ] SELECT `id`,`name` FROM `think_article_cate` [ RunTime:0.000170s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:18+08:00 ] 172.17.180.47 123.233.116.122 POST /admin/article/edit_article.html
[ log ] www.hhqblog.com/admin/article/edit_article.html [运行时间：0.030461s][吞吐率：32.83req/s] [内存消耗：3,424.05kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'edit_article',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'content-length' => '4744',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://www.hhqblog.com',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://www.hhqblog.com/admin/article/edit_article/id/40/html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
)
[ info ] [ PARAM ] array (
  'id' => '40',
  'title' => 'php中将二级分类归于一级分类下（非循环查表）',
  'cate_id' => '12',
  'type' => '0',
  'keyword' => 'php中将二级分类归于一级分类下（非循环查表）',
  'remark' => 'php中将二级分类归于一级分类下（非循环查表）',
  'file' => '',
  'content' => '<pre class="brush:php;toolbar:false">我会这样做：
先排序取出来，
$a&nbsp;=&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;3,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工xx&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;4,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1xx&#39;
&nbsp;&nbsp;&nbsp;&nbsp;],

];
$b&nbsp;=&nbsp;[];
foreach&nbsp;($a&nbsp;as&nbsp;$v)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($v[&#39;parentid&#39;]&nbsp;==&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;id&#39;]]&nbsp;=&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;$v[&#39;id&#39;],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;$v[&#39;categoryname&#39;],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;work_list2&#39;&nbsp;=&gt;&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;parentid&#39;]][&#39;work_list2&#39;][]&nbsp;=&nbsp;$v;
&nbsp;&nbsp;&nbsp;&nbsp;}
}

$b&nbsp;=&nbsp;array_values($b);</pre><p><br/></p>',
  'is_tui' => '1',
  'status' => '1',
  'views' => '1',
  'like' => '0',
  'auth' => '韩会强',
)
[ info ] [ RUN ] app\admin\controller\Article->edit_article[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000329s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000830s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `id` = 40 LIMIT 1 [ RunTime:0.000278s ]
[ sql ] [ SQL ] UPDATE `think_article`  SET `title`='php中将二级分类归于一级分类下（非循环查表）',`cate_id`=12,`type`=0,`keyword`='php中将二级分类归于一级分类下（非循环查表）',`remark`='php中将二级分类归于一级分类下（非循环查表）',`content`='<pre class=\"brush:php;toolbar:false\">我会这样做：\n先排序取出来，\n$a&nbsp;=&nbsp;[\n&nbsp;&nbsp;&nbsp;&nbsp;[\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;1,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;],\n&nbsp;&nbsp;&nbsp;&nbsp;[\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;2,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;0,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;],\n&nbsp;&nbsp;&nbsp;&nbsp;[\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;3,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;1,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工xx&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;],\n&nbsp;&nbsp;&nbsp;&nbsp;[\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;4,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;parentid&#39;&nbsp;=&gt;&nbsp;2,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;&#39;电工1xx&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;],\n\n];\n$b&nbsp;=&nbsp;[];\nforeach&nbsp;($a&nbsp;as&nbsp;$v)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($v[&#39;parentid&#39;]&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;id&#39;]]&nbsp;=&nbsp;[\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;$v[&#39;id&#39;],\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;categoryname&#39;&nbsp;=&gt;&nbsp;$v[&#39;categoryname&#39;],\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;work_list2&#39;&nbsp;=&gt;&nbsp;[]\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b[$v[&#39;parentid&#39;]][&#39;work_list2&#39;][]&nbsp;=&nbsp;$v;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\n\n$b&nbsp;=&nbsp;array_values($b);</pre><p><br/></p>',`is_tui`=1,`status`=1,`views`=1,`like`=0,`auth`='韩会强',`ip`='123.233.116.122',`update_time`=1501660218  WHERE  `id` = 40 [ RunTime:0.004364s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:20+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html
[ log ] www.hhqblog.com/admin/article/index.html [运行时间：0.026834s][吞吐率：37.27req/s] [内存消耗：3,818.80kb] [文件加载：53]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/admin/article/edit_article/id/40/html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/admin/view/article/index.html [ array (
  0 => 'allpage',
  1 => 'current',
  2 => 'keyword',
  3 => 'count',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000307s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000840s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000161s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000964s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:20+08:00 ] 172.17.180.47 123.233.116.122 GET /admin/article/index.html?page=1&keyword=
[ log ] www.hhqblog.com/admin/article/index.html?page=1&keyword= [运行时间：0.062996s][吞吐率：15.87req/s] [内存消耗：3,749.52kb] [文件加载：52]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'article',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://www.hhqblog.com/admin/article/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
  'keyword' => '',
)
[ info ] [ RUN ] app\admin\controller\Article->index[ /yjdata/www/hhqblog/application/admin/controller/Article.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000303s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000819s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` LIMIT 1 [ RunTime:0.000162s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` ORDER BY a.id desc LIMIT 0,10 [ RunTime:0.000954s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:32+08:00 ] 172.17.180.47 123.233.116.122 GET /
[ log ] www.hhqblog.com/ [运行时间：0.031956s][吞吐率：31.29req/s] [内存消耗：5,681.12kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'https://www.baidu.com/link?url=MY99dZu-3T7zFSrtiak7ibp3nneYwheuwc1Ipg4h_hhrseEXcpw6q0uepYw_YPi6&wd=&eqid=901379980000a9750000000259818446',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000281s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000801s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000573s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000372s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000284s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000757s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:32+08:00 ] 172.17.180.47 123.233.116.122 GET /index/index/index.html?page=1
[ log ] www.hhqblog.com/index/index/index.html?page=1 [运行时间：0.043135s][吞吐率：23.18req/s] [内存消耗：5,656.15kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'referer' => 'http://www.hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501659949.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000297s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000826s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000624s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000391s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000288s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000799s ]

---------------------------------------------------------------
[ 2017-08-02T15:50:40+08:00 ] 172.17.180.47 123.233.116.122 GET /ar/40
[ log ] www.hhqblog.com/ar/40 [运行时间：0.030000s][吞吐率：33.33req/s] [内存消耗：4,571.01kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://www.hhqblog.com/',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.8',
  'cookie' => '_pk_ref.1.c6f5=%5B%22%22%2C%22%22%2C1501659921%2C%22https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D8FVIg3VAFeKbRliM8LUpmhZea4MkFBrLb_tv2zJsW7dhB_rfQA9W7Q7tP70VZg7R%26wd%3D%26eqid%3Db0164bdb000082eb00000002598182fb%22%5D; _pk_id.1.c6f5=8954b2a892899c3c.1500952384.3.1501660234.1501659921.; _pk_ses.1.c6f5=*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '40',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000303s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000865s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000590s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 40 LIMIT 1 [ RunTime:0.000263s ]

---------------------------------------------------------------
[ 2017-08-02T16:02:42+08:00 ] 172.17.180.47 106.11.153.67 GET /index/index/index/cate_id/22.html
[ log ] www.hhqblog.com/index/index/index/cate_id/22.html [运行时间：0.034880s][吞吐率：28.67req/s] [内存消耗：5,680.50kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'accept-language' => 'zh-cn,en-us,zh-tw,en-gb,en;',
  'host' => 'www.hhqblog.com',
  'accept-encoding' => 'gzip',
  'accept' => '*/*',
  'connection' => 'Keep-Alive',
  'user-agent' => 'YisouSpider',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'cate_id' => '22',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000355s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000863s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000696s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000420s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000349s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.001011s ]

---------------------------------------------------------------
[ 2017-08-02T16:03:54+08:00 ] 172.17.180.47 54.159.218.103 GET /
[ log ] hhqblog.com/ [运行时间：0.035955s][吞吐率：27.81req/s] [内存消耗：5,679.76kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'accept' => '*/*',
  'accept-encoding' => 'gzip',
  'user-agent' => 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000314s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000858s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000615s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000387s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000305s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000820s ]

---------------------------------------------------------------
[ 2017-08-02T17:08:29+08:00 ] 172.17.180.47 123.125.71.70 GET /
[ log ] www.hhqblog.com/ [运行时间：0.037789s][吞吐率：26.46req/s] [内存消耗：5,616.91kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-language' => 'zh-cn,zh-tw',
  'if-none-match' => '"@NULL@"',
  'accept-encoding' => 'gzip',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000286s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000829s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.001004s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000494s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000381s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000331s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000321s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000263s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000608s ]

---------------------------------------------------------------
[ 2017-08-02T17:08:43+08:00 ] 172.17.180.47 111.206.221.113 GET /index/index/index.html?page=1
[ log ] www.hhqblog.com/index/index/index.html?page=1 [运行时间：0.054444s][吞吐率：18.37req/s] [内存消耗：5,645.43kb] [文件加载：55]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'index',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1 (compatible; Baiduspider-render/2.0; +http://www.baidu.com/search/spider.html)',
  'proxy-connection' => 'keep-alive',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'x-devtools-emulate-network-conditions-client-id' => 'fe35fb4f-8ad6-4069-ad94-fd8ad7e11ac5',
  'x-requested-with' => 'XMLHttpRequest',
  'accept-language' => 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',
  'resource-type' => '13',
  'referer' => 'http://www.hhqblog.com/',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'page' => '1',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000283s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000792s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000563s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000360s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000279s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000768s ]

---------------------------------------------------------------
[ 2017-08-02T17:41:49+08:00 ] 172.17.180.47 220.181.108.116 GET /ar/38.html
[ log ] www.hhqblog.com/ar/38.html [运行时间：0.040124s][吞吐率：24.92req/s] [内存消耗：4,987.37kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '38',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000380s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.001031s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000687s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 38 LIMIT 1 [ RunTime:0.000472s ]

---------------------------------------------------------------
[ 2017-08-02T17:44:46+08:00 ] 172.17.180.47 106.11.158.156 GET /
[ log ] www.hhqblog.com/ [运行时间：0.034205s][吞吐率：29.24req/s] [内存消耗：5,669.61kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'accept-language' => 'zh-cn,en-us,zh-tw,en-gb,en;',
  'host' => 'www.hhqblog.com',
  'accept-encoding' => 'gzip',
  'accept' => '*/*',
  'user-agent' => 'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre',
  'connection' => 'Keep-Alive',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000381s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000889s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000609s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000391s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000274s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000789s ]

---------------------------------------------------------------
[ 2017-08-02T18:00:29+08:00 ] 172.17.180.47 163.172.4.153 GET /
[ log ] hhqblog.com/ [运行时间：0.032935s][吞吐率：30.36req/s] [内存消耗：5,670.01kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'user-agent' => 'Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36',
  'connection' => 'Te',
  'accept' => 'text/html',
  'te' => 'trailers',
  'accept-language' => 'en-US;q=0.8, en;q=0.6',
  'accept-encoding' => 'gzip, deflate',
  'host' => 'hhqblog.com',
  'referer' => 'http://hhqblog.com/',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000310s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000823s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000618s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000391s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000285s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000814s ]

---------------------------------------------------------------
[ 2017-08-02T18:15:09+08:00 ] 172.17.180.47 220.181.108.163 GET /ar/40.html
[ log ] www.hhqblog.com/ar/40.html [运行时间：0.033556s][吞吐率：29.80req/s] [内存消耗：4,519.99kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '40',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000303s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000824s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.001093s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000554s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000421s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 40 LIMIT 1 [ RunTime:0.000258s ]

---------------------------------------------------------------
[ 2017-08-02T18:48:29+08:00 ] 172.17.180.47 220.181.108.106 GET /ar/37.html
[ log ] www.hhqblog.com/ar/37.html [运行时间：0.030399s][吞吐率：32.90req/s] [内存消耗：4,624.07kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '37',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000290s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000819s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000638s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 37 LIMIT 1 [ RunTime:0.000318s ]

---------------------------------------------------------------
[ 2017-08-02T20:20:59+08:00 ] 172.17.180.47 123.125.67.166 GET /
[ log ] hhqblog.com/ [运行时间：0.038081s][吞吐率：26.26req/s] [内存消耗：5,616.87kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000300s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000930s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.001030s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000538s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000392s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000338s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000321s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000296s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000720s ]

---------------------------------------------------------------
[ 2017-08-02T20:31:41+08:00 ] 172.17.180.47 123.125.67.160 GET /
[ log ] hhqblog.com/ [运行时间：0.032199s][吞吐率：31.06req/s] [内存消耗：5,669.73kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000280s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000817s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000579s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000371s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000264s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000763s ]

---------------------------------------------------------------
[ 2017-08-02T21:14:36+08:00 ] 172.17.180.47 123.125.67.162 GET /
[ log ] www.hhqblog.com/ [运行时间：0.032938s][吞吐率：30.36req/s] [内存消耗：5,669.66kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000323s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000840s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000597s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000425s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000312s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000849s ]

---------------------------------------------------------------
[ 2017-08-02T21:14:36+08:00 ] 172.17.180.47 123.125.67.165 GET /
[ log ] www.hhqblog.com/ [运行时间：0.034558s][吞吐率：28.94req/s] [内存消耗：5,669.66kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000364s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000939s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000616s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000401s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000310s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000750s ]

---------------------------------------------------------------
[ 2017-08-02T21:28:25+08:00 ] 172.17.180.47 157.55.39.81 GET /
[ log ] hhqblog.com/ [运行时间：0.035740s][吞吐率：27.98req/s] [内存消耗：5,617.19kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'cache-control' => 'no-cache',
  'connection' => 'Keep-Alive',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, deflate',
  'from' => 'bingbot(at)microsoft.com',
  'host' => 'hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000303s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000795s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000970s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000504s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000393s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000342s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000321s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000266s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000604s ]

---------------------------------------------------------------
[ 2017-08-02T22:57:29+08:00 ] 172.17.180.47 157.55.39.81 GET /
[ log ] www.hhqblog.com/ [运行时间：0.036014s][吞吐率：27.77req/s] [内存消耗：5,617.02kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'cache-control' => 'no-cache',
  'connection' => 'Keep-Alive',
  'pragma' => 'no-cache',
  'accept' => '*/*',
  'accept-encoding' => 'gzip, deflate',
  'from' => 'bingbot(at)microsoft.com',
  'host' => 'www.hhqblog.com',
  'user-agent' => 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000296s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000776s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `is_tui` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000988s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1 ORDER BY id desc LIMIT 8 [ RunTime:0.000562s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000356s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 1 ORDER BY id desc LIMIT 6 [ RunTime:0.000317s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000325s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000263s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000636s ]

---------------------------------------------------------------
[ 2017-08-02T23:06:09+08:00 ] 172.17.180.47 66.249.64.74 GET /
[ log ] hhqblog.com/ [运行时间：0.032219s][吞吐率：31.04req/s] [内存消耗：5,669.69kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'hhqblog.com',
  'connection' => 'Keep-alive',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
  'from' => 'googlebot(at)googlebot.com',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)',
  'accept-encoding' => 'gzip,deflate,br',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000296s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000814s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000575s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000378s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000265s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000736s ]

---------------------------------------------------------------
[ 2017-08-02T23:20:59+08:00 ] 172.17.180.47 123.125.71.70 GET /ar/39.html
[ log ] www.hhqblog.com/ar/39.html [运行时间：0.030210s][吞吐率：33.10req/s] [内存消耗：4,622.46kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'index',
    1 => 'Artical',
    2 => 'detail',
  ),
  'convert' => false,
)
[ info ] [ HEADER ] array (
  'host' => 'www.hhqblog.com',
  'connection' => 'close',
  'user-agent' => 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)',
  'accept-encoding' => 'gzip',
  'accept-language' => 'zh-cn,zh-tw',
  'accept' => '*/*',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
  'id' => '39',
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Artical->detail[ /yjdata/www/hhqblog/application/index/controller/Artical.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/artical/detail.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'article',
  5 => 'allpage',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000284s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000848s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000605s ]
[ sql ] [ SQL ] SELECT `a`.*,`ca`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ca` ON `a`.`cate_id`=`ca`.`id` WHERE  `a`.`id` = 39 LIMIT 1 [ RunTime:0.000290s ]

---------------------------------------------------------------
[ 2017-08-02T23:57:24+08:00 ] 172.17.180.47 95.24.11.48 GET /
[ log ] hhqblog.com/ [运行时间：0.031517s][吞吐率：31.73req/s] [内存消耗：5,670.47kb] [文件加载：56]
[ info ] [ LANG ] /yjdata/www/hhqblog/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'accept' => '*/*',
  'accept-language' => 'en-US',
  'referer' => 'http://yandex.ru/clck/jsredir?from=yandex.ru%3Bsearch%3Bweb%3B%3B&text=&etext=1501.mQNuy8YTW4p11nj7GAbqpFJW-UoE3WUmhVWmI1C1SYBZFfHxR4tXv_4ThPNR3kQk.d3034797081ad745a23eb0a65160a758b63251e4&uuid=&state=_BLhILn4SxNIvvL0W45KSic66uCIg23qh8iRG98qeIXmeppkgUc0YKCJkrjchpDstTwxTkjwGrA&data=UlNrNmk5WktYejR0eWJFYk1LdmtxbkJFREVvdTZEZkhYbFFfMlJ5b0k2YVdIeng0d3Fxbi1KM1ZxN0ROdVdoSzlhTG9tZjE1UDV4Rmh1bHcxS3NtRTZpZlhyYTItcUtR&b64e=2&sign=ee2c5849abffe57fcc748895baad8782&keyno=0&cst=AiuY0DBWFJ7IXge4WdYJQa9gkHE_3kbiCqGF3pPPacfxEjdxnv09GD0m3d91kWqRd4zogsO4FboAXhfRMkTG63wbc3auXK4-EzmTnQvrqyjGvL_J8cEvtS-oVMPc3EkKEoyBbTchjkzKIqkLdmf2WaTLDgo68f2L&ref=orjY4mGPRjk5boDnW0uvlrrd71vZw9kp5uQozpMtKCXIWKRFTcvmk8MHydNnLYCVzQBSV2fovPLROWPmz8-zMQbvCoWj-F-JOD6sTZ6u1YYdU7BgSfif9Q&l10n=ru&cts=1501689134897&mc=5.67373371207',
  'user-agent' => 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0; MDDCJS)',
  'accept-encoding' => 'gzip, deflate',
  'host' => 'hhqblog.com',
  'pragma' => 'no-cache',
  'connection' => 'close',
  'content-type' => '',
  'content-length' => '',
)
[ info ] [ PARAM ] array (
)
[ info ] [ CACHE ] INIT File
[ info ] [ DB ] INIT mysql
[ info ] [ RUN ] app\index\controller\Index->index[ /yjdata/www/hhqblog/application/index/controller/Index.php ]
[ info ] [ VIEW ] /yjdata/www/hhqblog/public/../application/index/view/index/index.html [ array (
  0 => 'menu',
  1 => 'recommend',
  2 => 'newarticle',
  3 => 'hot',
  4 => 'list',
  5 => 'allpage',
  6 => 'top_line',
  7 => 'carousel',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000296s ] mysql:dbname=hhqblog;host=127.0.0.1;port=3306;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `think_article` [ RunTime:0.000814s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` ORDER BY views desc LIMIT 8 [ RunTime:0.000569s ]
[ sql ] [ SQL ] SELECT * FROM `think_article` WHERE  `status` = 1  AND `type` = 2 ORDER BY id desc LIMIT 6 [ RunTime:0.000355s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `think_article` WHERE  `status` = 1 LIMIT 1 [ RunTime:0.000275s ]
[ sql ] [ SQL ] SELECT `a`.*,`ac`.`name` FROM `think_article` `a` LEFT JOIN `think_article_cate` `ac` ON `a`.`cate_id`=`ac`.`id` WHERE  `a`.`status` = 1 ORDER BY id desc LIMIT 0,15 [ RunTime:0.000707s ]

---------------------------------------------------------------
